**Merchant API**

 

 

**Введение**

** **

** **

**Механика запросов**

 

API поддерживает GET запросы и POST запросы с Content-type равным
form-data или x-www-form-urlencoded

Данные можно отправлять:

- Метод GET - данные передаются в GET параметрах, при передаче сложных
  структурированных данных, таких как многомерные массивы, используется
  следующий формат записи:
  [https://api.hillstarpay.com/script.php?param_1=val&param_2\[subParam_1\]=val2&](https://api.tezpayments.kg/script.php?param_1=val&param_2%5bsubParam_1%5d=val2&)
  param_2\[subParam_2\]=val3&param_3=val4

- Метод POST -- данные передаются в POST параметрах. Структурные данные
  при работе через POST, формируются аналогичным образом.

- Через XML - запросы передаются также методом Post, только в
  единственном параметре pg_xml, представленный в XML виде:

 

**\<?xml version=\"1.0\"
encoding=\"utf-8\"?\>\<request\>\<pg_param1\>value1\</pg_param\>\<pg_param2\>value2\</pg_param\>\</request\>**

** **

** **

** **

**Формирование подписи**

 

 

Любые сообщения (запросы и ответы) между Hillstarpay и мерчантом
подписываются. Для формирования подписи необходимо конкатенировать с
разделителем ;

- имя вызываемого скрипта (от последнего / до конца или ?)

- все поля сообщения в алфавитном порядке, включая случайную строку
  pg_salt, состоящую из произвольного количества цифр и латинских букв,
  при этом:\
  a. к вложенным тегам это правило применяется рекурсивно (только XML)\
  b. поля с одинаковыми именами берутся в том порядке, в котором они
  присутствуют в сообщении

- и платежный пароль secret_key, который задается в настройках магазина
  и известен только мерчанту и Hillstarpay.

От полученной в результате конкатенации строки необходимо вычислить md5
и добавить в запрос или ответ в качестве дополнительного параметра
pg_sig. MD5 хэш записывается в виде шестнадцатеричной строки в нижнем
регистре (32 символа).

Любая сторона может добавлять в запрос или ответ дополнительные
параметры, не указанные в документации. Эти параметры также участвуют в
вычислении подписи. Сообщение не подписывается, и соответственно поля
pg_salt и pg_sig отсутствуют только в одном случае -- когда Hillstarpay
не смог идентифицировать мерчанта и поэтому не знает его secret_key. В
таком случае поле pg_error_code (числовой код ошибки) принимает значение
101. Полный список возможных значений поля pg_error_code см. в разделе
**Справочник кодов ошибок.**

** **

** **

** **

**Тестовые карты**

 

 

Все новые мерчанты первоначально находятся в тестовом режиме, затем
после завершения тестирования и отправки мерчантом в Hillstarpay
подписанного Акта о подключении администрация Hillstarpay переводит
мерчант в рабочий режим.

В тестовом режиме можно использовать только тестовые платежные методы, а
в рабочем режиме, наоборот, оплата тестовыми платежными методами
невозможна.

После перехода мерчанта в рабочий режим можно создавать отдельные
транзакции в тестовом режиме, передавая параметр pg_testing_mode в
запросах на создание платежа и на получение списка платежных методов.
Значение pg_testing_mode=1 включает тестовый режим для одной конкретной
транзакции. Для проведения тестовых транзакций в боевом режиме
необходимо обратится менеджеру для уточнения деталей.\
Если сам мерчант находится в тестовом режиме, то значение переданного
флага pg_testing_mode не имеет значения. Включение и выключение
тестового режима в настройках мерчанта осуществляется только
администрацией Hillstarpay.

После создания транзакции никаких автоматических действий с ней не
происходит. Для того, чтобы протестировать дальнейшее прохождение
транзакции нужно зайти в административную панель, и войти в транзакцию.
Далее управлять ее действиями с помощью тестовых кнопок.

В качестве имени карте нужно указывать от 2 слов в английской раскладке.

Пароль для 3-D Secure проверки: 12345678\
Список тестовых карт:

  ----------------------------------------------------------------------------
  **Номер карты**    **CVV**   **Срок       **Код      **Результат по карте**
                               действия**   ответа**   
  ------------------ --------- ------------ ---------- -----------------------
  4444444444446666   123       2030/12      20010      Операция отклонена.
                                                       Обратитесь в банк,
                                                       выпустивший карту.

  4111111111111111   123       2030/12      0          Успешная операция.

  4563960122001999   123       2030/12      71015      Операция отклонена.
                                                       Проверьте введенные
                                                       данные, достаточность
                                                       средств на счёте и
                                                       повторите операцию.

  5555555555555557   123       2030/12      151017     Операция отклонена.
                                                       Обратитесь в магазин.

  5555555555555599   123       2030/12      0          Успешная операция.

  4444444444444422   123       2030/12      913        Операция отклонена.
                                                       Обратитесь в банк,
                                                       выпустивший карту.

  4444444411111111   123       2030/12      120        Операция отклонена.
                                                       Обратитесь в банк,
                                                       выпустивший карту.

  4444444499999999   123       2030/12      151017     Операция отклонена.
                                                       Обратитесь в магазин.
  ----------------------------------------------------------------------------

** **

** **

**Тестовые номера телефонов**

 

Механика мобильной коммерции подразумевает тестирование в рамках ряда
операторов.\
Ниже будут предоставлены номера и соответствующие им OTP коды для
проведения тестов

Список номеров:

  ---------------------------------------
  **Оператор**   **Номер         **OTP
                 телефона**      код**
  -------------- --------------- --------
  Кселл          +77017777777    111111

  Актив          +77027777777    111111

  Теле2          +77037777777    111111

  Алтел          +77047777777    111111
  ---------------------------------------

** **

** **

** **

**Прием платежей**

 

 

 

В этом разделе описана механика, при которой Hillstarpay списывает
деньги в пользу мерчанта и впоследствии перечисляет их на
соответствующий расчетный счет.

Прием платежей с помощью банковских карт и мобильной коммерции может
проводиться в тестовом режиме. Другие способы будут доступны только в
боевом режиме.

 

 

**Платежная страница**

 

 

**Инициализация платежа**

 

Запрос:

 

curl \--location \--request POST
\'[https://api.hillstarpay.com/init_payment.php\'](https://api.greenleavespay.kz/init_payment.php)
\\

\--form \'pg_order_id=23\' \\

\--form \'pg_merchant_id={{Hillstarpay_merchant_id}}\' \\

\--form \'pg_amount=25\' \\

\--form \'pg_description=test\' \\

\--form \'pg_salt=molbulak\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\'

\# Пример подписи:

\'init_payment.php;25;test;{{Hillstarpay_merchant_id}};23;molbulak;{{secret_key}}\'

 

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_payment_id\>4567788\</pg_payment_id\>

\<pg_redirect_url\>https://api.hillstarpay.com/pay.html?customer=498333170d6a895148c57c53ffb18287\</pg_redirect_url\>

\<pg_redirect_url_type\>need data\</pg_redirect_url_type\>

\<pg_salt\>bdwLavL9lg6It91b\</pg_salt\>

\<pg_sig\>709633e91387c56ac6fb7cb33d1e07d8\</pg_sig\>

\</response\>

 

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

 

\$request = \$requestForSignature = \[

\'pg_order_id\' =\> \'23\',

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_amount\' =\> \'25\',

\'pg_description\' =\> \'test\',

\'pg_salt\' =\> \'molbulak\',

\'pg_currency\' =\> \'KZT\',

\'pg_check_url\' =\> \'[http://site.kz/check\'](http://site.kz/check),

\'pg_result_url\' =\>
\'[http://site.kz/result\'](http://site.kz/result),

\'pg_request_method\' =\> \'POST\',

\'pg_success_url\' =\>
\'[http://site.kz/success\'](http://site.kz/success),

\'pg_failure_url\' =\>
\'[http://site.kz/failure\'](http://site.kz/failure),

\'pg_success_url_method\' =\> \'GET\',

\'pg_failure_url_method\' =\> \'GET\',

\'pg_state_url\' =\> \'[http://site.kz/state\'](http://site.kz/state),

\'pg_state_url_method\' =\> \'GET\',

\'pg_site_url\' =\> \'[http://site.kz/return\'](http://site.kz/return),

\'pg_payment_system\' =\> \'EPAYWEBKZT\',

\'pg_lifetime\' =\> \'86400\',

\'pg_user_phone\' =\> \'77777777777\',

\'pg_user_contact_email\' =\>
\'[mail@customer.kz\',](mailto:mail@customer.kz)

\'pg_user_ip\' =\> \'127.0.0.1\',

\'pg_postpone_payment\' =\> \'0\',

\'pg_language\' =\> \'ru\',

\'pg_testing_mode\' =\> \'1\',

\'pg_user_id\' =\> \'1\',

\'pg_recurring_start\' =\> \'1\',

\'pg_recurring_lifetime\' =\> \'156\',

\'pg_user_id\' =\> \'1\',

\'pg_param1\' =\> \'дополнительные данные\',

\'pg_param2\' =\> \'дополнительные данные\',

\'pg_param3\' =\> \'дополнительные данные\',

\];

/\*\*

\* Функция превращает многомерный массив в плоский

\*/

function makeFlatParamsArray(\$arrParams, \$parent_name = \'\')

{

\$arrFlatParams = \[\];

\$i = 0;

foreach (\$arrParams as \$key =\> \$val) {

\$i++;

/\*\*

\* Имя делаем вида tag001subtag001

\* Чтобы можно было потом нормально отсортировать и вложенные узлы не
запутались при сортировке

\*/

\$name = \$parent_name . \$key . sprintf(\'%03d\', \$i);

if (is_array(\$val)) {

\$arrFlatParams = array_merge(\$arrFlatParams,
makeFlatParamsArray(\$val, \$name));

continue;

}

\$arrFlatParams += array(\$name =\> (string)\$val);

}

return \$arrFlatParams;

}

// Превращаем объект запроса в плоский массив

\$requestForSignature = makeFlatParamsArray(\$requestForSignature);

// Генерация подписи

ksort(\$requestForSignature); // Сортировка по ключю

array_unshift(\$requestForSignature, \'init_payment.php\'); //
Добавление в начало имени скрипта

array_push(\$requestForSignature, \$secret_key); // Добавление в конец
секретного ключа

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$requestForSignature)); //
Полученная подпись

 

 

Есть два варианта использования метода:

- Прямая передача данных от мерчанта в Hillstarpay

- Передача данных через браузер пользователя в Hillstarpay

При прямой передаче данных от мерчанта в Hillstarpay, мерчант должен
посылать данные на init_payment.php.

При передаче данных через браузер пользователя в Hillstarpay, мерчант
должен направить пользователя с данными на payment.php.

Можно передавать произвольные дополнительные параметры, имена которых не
начинаются на pg\_. Все эти параметры будут переданы на pg_check_url и
pg_result_url.

Имена дополнительных параметров мерчанта должны быть уникальны.

После получение параметра pg_redirect_url пользователя перенаправляют на
платежную страницу, где плательщик завершает платеж.

В случае успеха пользователь будет перенаправлен на страницу оплаты.

В случае если мерчантом переданы не все параметры, необходимые для
создания платежной транзакции (платежная система, телефон пользователя и
параметры, необходимые для выбранной платежной системы), они
запрашиваются у пользователя на сайте hillstarpay.com.

 

**URL запроса**

POST
[https://api.hillstarpay.com/init_payment.php](https://api.tezpayments.kg/init_payment.php)

 

**Поля запроса:**

  ------------------------------------------------------------------------------
  **Название**                            **Описание**                 **Тип**
  --------------------------------------- ---------------------------- ---------
  pg_order_id\                            Идентификатор платежа в      string
  required                                системе мерчанта.            
                                          Рекомендуется поддерживать   
                                          уникальность этого поля.\    
                                          Пример: 00102                

  pg_merchant_id\                         Идентификатор мерчанта в     integer
  required                                Hillstarpay Выдается при     
                                          подключении.                 

  pg_amount\                              Сумма платежа в валюте       number
  required                                pg_currency.\                
                                          Минимум 0.01\                
                                          Пример: 10                   

  pg_description\                         Описание товара или услуги.  string
  required                                Отображается покупателю в    
                                          процессе платежа.\           
                                          Пример: Ticket               

  pg_salt\                                Случайная строка\            string
  required                                Пример: some random string   

  pg_sig\                                 Подпись запроса              string
  required                                                             

  pg_currency                             Валюта, в которой указана    string
                                          сумма. KZT, USD, EUR. В      
                                          случае выбора покупателем    
                                          способа платежа в другой     
                                          валюте, производится         
                                          пересчет по курсу ЦБ на день 
                                          платежа. См. в разделе       
                                          Справочник валют\            
                                          Пример: KZT                  

  pg_check_url                            URL для проверки возможности string
                                          платежа. Вызывается перед    
                                          платежом, если платежная     
                                          система предоставляет такую  
                                          возможность. Если параметр   
                                          не указан, то берется из     
                                          настроек магазина. Если      
                                          параметр установлен равным   
                                          пустой строке, то проверка   
                                          возможности платежа не       
                                          производится.                

  pg_result_url                           URL для сообщения о          string
                                          результате платежа.          
                                          Вызывается после платежа в   
                                          случае успеха или неудачи.   
                                          Если параметр не указан, то  
                                          берется из настроек          
                                          магазина. Является           
                                          обязательным, если не задан  
                                          в настройках магазина. Если  
                                          параметр установлен равным   
                                          пустой строке, то            
                                          Hillstarpay не сообщает      
                                          магазину о результате        
                                          платежа.                     

  pg_request_method                       GET, POST или XML -- метод   string
                                          вызова скриптов магазина     
                                          Check URL, Result URL, для   
                                          передачи информации от       
                                          платежного гейта.\           
                                          Пример: POST                 

  pg_success_url                          url, на который отправляется string
                                          пользователь в случае        
                                          успешного платежа (только    
                                          для online систем). Является 
                                          обязательным, если не задан  
                                          в настройках магазина.       

  pg_failure_url                          url, на который отправляется string
                                          пользователь в случае        
                                          неуспешного платежа (только  
                                          для online систем). Является 
                                          обязательным, если не задан  
                                          в настройках магазина.       

  pg_success_url_method                   GET -- кнопка, которая       string
                                          сабмитится методом GET. POST 
                                          -- кнопка, которая           
                                          сабмитится методом POST.     
                                          Если выбран метод GET или    
                                          POST, то страница с          
                                          подтверждением оплаты        
                                          показывается пользователю на 
                                          сайте hillstarpay.com, и     
                                          предлагается нажать кнопку,  
                                          чтобы вернуться на сайт      
                                          магазина.\                   
                                          Пример: GET                  

  pg_failure_url_method                   GET -- кнопка, которая       string
                                          сабмитится методом GET. POST 
                                          -- кнопка, которая           
                                          сабмитится методом POST.     
                                          Если выбран метод GET или    
                                          POST, то страница с          
                                          сообщением о неудавшейся     
                                          оплате показывается          
                                          пользователю на сайте        
                                          hillstarpay.com, и           
                                          предлагается нажать кнопку,  
                                          чтобы вернуться на сайт      
                                          магазина.\                   
                                          Пример: GET                  

  pg_state_url                            URL скрипта на сайте         string
                                          магазина, куда               
                                          перенаправляется покупатель  
                                          для ожидания ответа от       
                                          платежной системы.\          
                                          Пример:                      
                                          <http://site.kz/state>       

  pg_state_url_method                     GET -- кнопка, которая       string
                                          сабмитится методом GET.\     
                                          POST -- кнопка, которая      
                                          сабмитится методом POST.\    
                                          AUTOGET -- 302 редирект. См. 
                                          Автоматическая передача      
                                          информации, п.1.\            
                                          AUTOPOST -- форма, которая   
                                          автоматически сабмитится.    
                                          См. Автоматическая передача  
                                          информации, п.2.\            
                                          Если выбран метод GET или    
                                          POST, то страница с          
                                          сообщением о неудавшейся     
                                          оплате показывается          
                                          пользователю на сайте        
                                          hillstarpay.com, и           
                                          предлагается нажать кнопку,  
                                          чтобы вернуться на сайт      
                                          магазина.\                   
                                          Если выбран метод AUTOGET    
                                          или AUTOPOST, то страница с  
                                          сообщением о неудавшейся     
                                          оплате не показывается       
                                          пользователю, и пользователь 
                                          сразу передается магазину.\  
                                          Пример: GET                  

  pg_site_url                             URL сайта магазина для       string
                                          показа покупателю ссылки, по 
                                          которой он может вернуться   
                                          на сайт магазина после       
                                          создания счета. Применяется  
                                          для offline ПС (наличные).\  
                                          Пример:                      
                                          <http://site.kz/return>      

  pg_payment_system                       Идентификатор платежной      string
                                          системы. Этот параметр       
                                          передается только если выбор 
                                          платежной системы            
                                          совершается на сайте         
                                          мерчанта. Если параметр не   
                                          указан, то выбор ПС          
                                          совершается на сайте         
                                          hillstarpay.com\             
                                          Пример: EPAYWEBKZT           

  pg_lifetime                             Default: \"86400\"\          integer
                                          Время (в секундах) в течение 
                                          которого платеж должен быть  
                                          завершен, в противном случае 
                                          заказ при проведении платежа 
                                          Hillstarpay откажет          
                                          платежной системе в          
                                          проведении. Этот параметр    
                                          контролируется Hillstarpay,  
                                          а также, если платежная      
                                          система поддерживает такую   
                                          возможность, и платежной     
                                          системой. Минимально         
                                          допустимое значение: 300     
                                          секунд (5 минут).            
                                          Максимально допустимое       
                                          значение: 604800 секунд (7   
                                          суток). В случае выхода за   
                                          пограничные значения будет   
                                          присвоено минимальное или    
                                          максимальное значение,       
                                          соответственно.\             
                                          Пример: 86400                

  pg_user_phone                           Телефон пользователя         string
                                          (начиная с кода страны),     
                                          необходим для идентификации  
                                          покупателя. Если не указан,  
                                          выбор будет предложен        
                                          пользователю на сайте        
                                          платежного гейта.\           
                                          Пример: 77777777777          

  pg_user_contact_email                   Контактный адрес электронной string
                                          почты пользователя. Если     
                                          указан, на этот адрес будут  
                                          высылаться уведомления об    
                                          изменении статуса            
                                          транзакции.\                 
                                          Пример: mail@customer.kz     

  pg_user_ip                              IP-адрес клиента. Необходим  string
                                          для разбора спорных ситуаций 
                                          в случае подозрения на       
                                          мошенничество. Параметр      
                                          можно не передавать при      
                                          передаче информации через    
                                          браузер пользователя, в этом 
                                          случае будет записан тот IP, 
                                          с которого пользователь      
                                          перешёл на страницу          
                                          инициализации платежа.\      
                                          Пример: 127.0.0.1            

  pg_postpone_payment                     Создание платежа с           integer
                                          отложенной оплатой если в    
                                          этом параметре передано «1». 
                                          В таком случае покупатель    
                                          будет перенаправлен на       
                                          страницу с информацией о     
                                          том, что ему было выслано    
                                          письмо со ссылкой на         
                                          страницу для продолжения     
                                          проведения платежа. Если     
                                          этот параметр присутствует в 
                                          запросе, то должен быть      
                                          указан также                 
                                          pg_user_contact_email, иначе 
                                          пользователь будет           
                                          перенаправлен на уточнение   
                                          платежных параметров, где он 
                                          сможет, указать email и      
                                          попробовать отложить платеж  
                                          ещё раз.\                    
                                          Пример: 0                    

  pg_language                             Язык платежных страниц на    string
                                          сайте Hillstarpay и (если    
                                          возможно) платежных систем.  
                                          \"en\", \"ru\"\              
                                          Пример: ru                   

  pg_testing_mode                         Создание платежа в тестовом  integer
                                          режиме.\                     
                                          Пример: 1                    

  pg_user_id                              ID пользователя в системе    string
                                          мерчанта.\                   
                                          Пример: No65GFR755789T,      
                                          25642588                     

  pg_recurring_start                      Флаг, принимает значение 0   integer
                                          или 1. Подробное описание    
                                          см. в разделе Рекуррентные   
                                          платежи. Для использования   
                                          данного параметра Вам        
                                          следует обратиться к своему  
                                          менеджеру.\                  
                                          Пример: 1                    

  pg_recurring_lifetime                   Время на продолжении         integer
                                          которого мерчант             
                                          рассчитывает использовать    
                                          профиль рекуррентных         
                                          платежей. Минимально         
                                          допустимое значение 1 (1     
                                          месяц). Максимально          
                                          допустимое значение: 156 (13 
                                          лет). В случае выхода за     
                                          пограничные значения будет   
                                          присвоено минимальное или    
                                          максимальное значение,       
                                          соответственно. Подробное    
                                          описание см. в разделе       
                                          Рекуррентные платежи. Для    
                                          использования данного        
                                          параметра Вам следует        
                                          обратиться к своему          
                                          менеджеру.\                  
                                          Пример: 156                  

  pg_receipt_positions\[0\]\[count\]      Количество товара.\          integer
                                          Пример: 2                    

  pg_receipt_positions\[0\]\[name\]       Наименование товара\         string
                                          Пример: Коврик для мыши      

  pg_receipt_positions\[0\]\[tax_type\]   Тип налога.\                 integer
                                          Возможные значения:\         
                                          0 - Без налога\              
                                          1 - НДС 0%\                  
                                          2 - НДС 12%\                 
                                          3 - НДС 12/112\              
                                          4 - НДС 18%\                 
                                          5 - НДС 18/118\              
                                          6 - НДС 10%\                 
                                          7 - НДС 10/110\              
                                          8 - НДС 20%\                 
                                          9 - НДС 20/120               

  pg_receipt_positions\[0\]\[price\]      Цена за 1 ед. товара.\       number
                                          Пример: 1000                 

  pg_param1                               Дополнительный параметр 1\   string
                                          Пример: Дополнительная       
                                          информация                   

  pg_param2                               Дополнительный параметр 2\   string
                                          Пример: Дополнительная       
                                          информация                   

  pg_param3                               Дополнительный параметр 3\   string
                                          Пример: Дополнительная       
                                          информация                   

  pg_auto_clearing                        Если 1 клиринг будет         integer
                                          происходить сразу, в случае  
                                          0 необходимо сделать ручной  
                                          клиринг. Подробное описание  
                                          см. в разделе Запрос на      
                                          клиринг транзакций по        
                                          банковским картам. Для       
                                          использования данного        
                                          параметра Вам следует        
                                          обратиться к своему          
                                          менеджеру.\                  
                                          Пример: 1                    

  pg_payment_method                       Значение - Метод платежа\    string
                                          wallet - Электронные деньги\ 
                                          internetbank -               
                                          Интернет-банкинг\            
                                          other - Терминалы\           
                                          bankcard - Банковские карты\ 
                                          cash - Точки приема          
                                          платежей\                    
                                          mobile_commerce - Мобильная  
                                          коммерция\                   
                                          \                            
                                          Пример: mobile_commerce      

  pg_timeout_after_payment                Определяет время закрытия    integer
                                          страницы с платежом в        
                                          секундах\                    
                                          Пример: 10                   

  pg_generate_qr                          В случае, если вы хотите     boolean
                                          получать QR код со ссылкой   
                                          на платежную форму           
                                          Hillstarpay в формате        
                                          base64, в параметре          
                                          pg_generate_qr необходимо    
                                          отправить «1»                

  pg_3ds_challenge                        Определяет необходимость     integer
                                          прохождения Challenge Flow   
                                          (1 - обязательно провести    
                                          Challenge Requested, 0 или   
                                          пусто - метод определяется   
                                          эмитентом)\                  
                                          \                            
                                          банк-эмитент может           
                                          игнорировать данный параметр 
                                          и провести платеж по своему  
                                          Challenge Flow               

  pg_commission_discount                  В случае, если вы хотите     boolean
                                          использовать скидку на       
                                          комиссию, то необходимо      
                                          отправить 1. Скидка работает 
                                          только на комиссию сверху.   
                                          Для использования метода     
                                          обратитесь к персональному   
                                          менеджеру                    

  pg_commission_discount_fix              Для использования            number
                                          фиксированной суммы скидки   

  pg_commission_discount_percentage       Для использования процентной number
                                          скидки                       
  ------------------------------------------------------------------------------

** **

** **

**Параметры ответа:**

+----------------------+------------------------------------+---------+
| **Название**         | **Описание**                       | **Тип** |
+======================+====================================+=========+
| pg_status            | Показывает результат выполнения    | string  |
|                      | запроса                            |         |
|                      |                                    |         |
|                      |   -----------------------------    |         |
|                      |   Статус   Описание                |         |
|                      |   -------- --------------------    |         |
|                      |   ok       Запрос прошел           |         |
|                      |            успешно                 |         |
|                      |                                    |         |
|                      |   error    Запрос прошел с         |         |
|                      |            ошибкой                 |         |
|                      |   -----------------------------    |         |
+----------------------+------------------------------------+---------+
| pg_payment_id        | Уникальный идентификатор платежной | integer |
|                      | транзакции в Hillstarpay cлужит    |         |
|                      | ключом для всей дальнейшей работы  |         |
|                      | с транзакцией                      |         |
+----------------------+------------------------------------+---------+
| pg_redirect_url      | URL для перенаправления            | string  |
|                      | пользователя. Может быть как на    |         |
|                      | сайте hillstarpay.com, так и на    |         |
|                      | сайте платежной системы            |         |
+----------------------+------------------------------------+---------+
| pg_redirect_url_type | Тип страницы, на которую           | string  |
|                      | происходит перенаправление.        |         |
|                      | Возможные значения:\               |         |
|                      | need data -- диалог с покупателем  |         |
|                      | с целью уточнения параметров:      |         |
|                      | платежной системы, номера          |         |
|                      | телефона, обязательных для данной  |         |
|                      | платежной системы параметров;\     |         |
|                      | payment system -- страница сайта   |         |
|                      | платежной системы либо страница с  |         |
|                      | инструкциями оплаты через данную   |         |
|                      | платежную систему. Страница с      |         |
|                      | инструкциями может располагаться   |         |
|                      | как на сайте hillstarpay.com, так  |         |
|                      | и на сайте мерчанта.\              |         |
|                      | \                                  |         |
|                      | В случае получения мерчантом       |         |
|                      | ответа с                           |         |
|                      | pg_redirect_url_type="need data",  |         |
|                      | мерчант может не перенаправлять    |         |
|                      | покупателя по полученному URL, а   |         |
|                      | уточнить недостающие параметры у   |         |
|                      | себя на сайте. В этом случае после |         |
|                      | уточнения параметров и повторного  |         |
|                      | запроса на создание платежной      |         |
|                      | транзакции будет создана новая     |         |
|                      | транзакция                         |         |
+----------------------+------------------------------------+---------+
| pg_redirect_qr       | URL для перенаправления            | string  |
|                      | пользователя в виде QR. Передается |         |
|                      | в формате base64                   |         |
+----------------------+------------------------------------+---------+
| pg_salt              | Случайная строка                   | string  |
+----------------------+------------------------------------+---------+
| pg_sig               | Подпись запроса                    | string  |
+----------------------+------------------------------------+---------+

 

 

 

**Запрос на check_url магазина. Проверка возможности совершить платеж.**

 

Пример отрицательного ответа магазина

 

Запрос:

 

curl \--location \--request POST \'{{check_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_amount=10\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_ps_amount=5\' \\

\--form \'pg_ps_full_amount=5\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\'

 

 

 

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>rejected\</pg_status\>

\<pg_description\>Платеж не разрешен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

Пример положительного ответа магазина

 

Запрос:

 

curl \--location \--request POST \'{{check_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_amount=10\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_ps_amount=5\' \\

\--form \'pg_ps_full_amount=5\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\'

 

 

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_description\>Платеж разрешен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

Для использования данного запроса Вам следует обратиться к своему
менеджеру.

Перед тем как принять деньги от покупателя по счету, платежный гейт
может вызвать скрипт мерчанта Check URL с помощью метода Request Method.

Hillstarpay передает информацию о номере, свойствах заказа и ожидает
ответа. Отсутствие ответа за указанное время воспринимается как отказ от
платежа.

Check URL на стороне мерчанта должен быть общедоступным, без
авторизации.

Вызов скрипта Check URL происходит только в случае, если такая опция
была включена в настройках мерчанта.

Ответ на check_url от мерчанта

Если Check URL определен пустым в момент инициализации платежа или не
указан в момент инициализации платежа, а в настройках мерчанта
установлен пустым, то шаг проверки возможности платежа пропускается и
считается, что магазин согласен принять платеж

- В случае если магазин подтверждает готовность заказа и правильность
  суммы, он должен ответить в виде XML со статусом ok

- В случае отказа от платежа rejected

- error - ошибка в интерпретации данных

 

 

 

***URL запроса***

POST {{check_url}}

** **

** **

**Поля запроса:**

  -----------------------------------------------------------------
  **Название**        **Описание**                        **Тип**
  ------------------- ----------------------------------- ---------
  pg_order_id         Идентификатор заказа в системе      string
                      мерчанта\                           
                      Пример: 123456789                   

  pg_payment_id       Внутренний идентификатор платежа в  integer
                      системе Hillstarpay\                
                      Пример: 12345                       

  pg_amount           Сумма выставленного счета (в валюте number
                      pg_currency), совпадает с pg_amount 
                      в момент инициализации платежа.\    
                      Пример: 10                          

  pg_currency         Валюта выставленного счета,         string
                      совпадает с pg_currency в момент    
                      инициализации платежа.\             
                      Пример: KZT                         

  pg_ps_currency      Валюта, в которой был произведен    string
                      платеж в платежной системе. Поле    
                      может отсутствовать в случае        
                      неудачного платежа\                 
                      Пример: KZT                         

  pg_ps_amount        Сумма счета (в валюте               number
                      pg_ps_currency), выставленного в    
                      платежной системе.\                 
                      Пример: 5                           

  pg_ps_full_amount   Полная сумма (в валюте              number
                      pg_ps_currency), которую заплатит   
                      покупатель с учетом всех комиссий.\ 
                      Пример: 5                           

  Параметры мерчанта  Все поля, переданные с веб-сайта    string
                      мерчанта, не имеющие префикса pg\_  

  pg_salt             Случайная строка\                   string
                      Пример: some random string          

  pg_sig              Подпись запроса                     string
  -----------------------------------------------------------------

 

 

**Запрос на result_url магазина. Результат платежа**

 

 

Пример отрицательного ответа магазина

 

Запрос:

 

curl \--location \--request POST \'{{result_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_amount=500\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_net_amount=482.5\' \\

\--form \'pg_ps_amount=500\' \\

\--form \'pg_ps_full_amount=500\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_description=Покупка в интернет магазине Site.kz\' \\

\--form \'pg_result=0\' \\

\--form \'pg_payment_date=2019-01-01 12:00:00\' \\

\--form \'pg_can_reject=1\' \\

\--form \'pg_user_phone=7077777777777\' \\

\--form \'[pg_user_contact_email=mail@customer.kz\'
\\](mailto:pg_user_contact_email=mail@customer.kz)

\--form \'pg_need_email_notification=1\' \\

\--form \'pg_testing_mode=1\' \\

\--form \'pg_captured=0\' \\

\--form \'pg_card_pan=5483-18XX-XXXX-0293\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\' \\

\--form \'pg_payment_method=bankcard\'

 

 

Ответ

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>rejected\</pg_status\>

\<pg_description\>Платеж отменен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

Пример положительного ответа магазина

 

Запрос:

 

curl \--location \--request POST \'{{result_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_amount=500\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_net_amount=482.5\' \\

\--form \'pg_ps_amount=500\' \\

\--form \'pg_ps_full_amount=500\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_description=Покупка в интернет магазине Site.kz\' \\

\--form \'pg_result=1\' \\

\--form \'pg_payment_date=2019-01-01 12:00:00\' \\

\--form \'pg_can_reject=1\' \\

\--form \'pg_user_phone=7077777777777\' \\

\--form \'[pg_user_contact_email=mail@customer.kz\'
\\](mailto:pg_user_contact_email=mail@customer.kz)

\--form \'pg_need_email_notification=1\' \\

\--form \'pg_testing_mode=1\' \\

\--form \'pg_captured=0\' \\

\--form \'pg_card_pan=5483-18XX-XXXX-0293\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\' \\

\--form \'pg_payment_method=bankcard\'

 

 

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_description\>Заказ оплачен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

После приема оплаты от клиента или при невозможности совершить платеж
Hillstarpay вызывает Result URL магазина и передает на него методом
Request Method информацию о результате платежа.

При получении данного запроса мерчант должен произвести необходимые
действия для передачи товара или услуги покупателю, в случае если платеж
был успешным. Если pg_can_reject равно 1 и мерчант не может принять
платеж (например, бронь на билеты истекла), он обязан ответить со
статусом rejected, и Hillstarpay отзовет платеж. В этом случае поле
pg_description из ответа мерчанта показывается пользователю как причина
отказа.

Result URL на стороне мерчанта должен быть общедоступным, без
авторизации.

Если сервер мерчанта недоступен в момент вызова Result URL или ответ от
сервера был не со статусом 200, Hillstarpay будет предпринимать
повторные попытки его вызвать каждые полчаса в течение 2 часов, даже
если время жизни счета pg_lifetime истечет.

Если первая попытка вызова Result URL оказалась неуспешной, то платеж не
отменяется, и в последующих вызовах Result URL не позволяет магазину
отказаться от платежа.

Магазин должен быть готов к тому, что Result URL будет вызван повторно
для одного и того же платежа. Ответы на повторные вызовы должны
совпадать с первоначальным ответом, даже если время жизни транзакции
pg_lifetime истекло.

Ответ на result_url от мерчанта

Статус rejected может быть возвращен мерчантом только в случае, когда во
входящем запросе от гейта был указан параметр pg_can_reject равный 1, в
противном случае, вне зависимости от ответа мерчанта, платеж будет
считаться совершенным. Если мерчант отказался от платежа (ответил
rejected), покупатель перенаправляется на Failure URL, иначе -- на
Success URL.

- ok - платеж принят

- rejected - отказ от платежа случае если pg_can_reject равен 1

- error - ошибка в интерпретации данных

 

 

**URL запроса**

POST {{result_url}}

 

**Поля запроса:**

+-----------------------+----------------------------------------+----------+
| **Название**          | **Описание**                           | **Тип**  |
+=======================+========================================+==========+
| pg_order_id           | Идентификатор заказа в системе         | string   |
|                       | мерчанта\                              |          |
|                       | Пример: 123456789                      |          |
+-----------------------+----------------------------------------+----------+
| pg_payment_id         | Внутренний идентификатор платежа в     | integer  |
|                       | системе Hillstarpay\                   |          |
|                       | Пример: 12345                          |          |
+-----------------------+----------------------------------------+----------+
| pg_amount             | Сумма выставленного счета в валюте     | string   |
|                       | pg_currency\                           |          |
|                       | Пример: 500                            |          |
+-----------------------+----------------------------------------+----------+
| pg_currency           | Валюта выставленного счета, совпадает  | string   |
|                       | с pg_currency в момент инициализации   |          |
|                       | платежа\                               |          |
|                       | Пример: KZT                            |          |
+-----------------------+----------------------------------------+----------+
| pg_net_amount         | Сумма счета (в валюте                  | string   |
|                       | \`pg_ps_currency), выставленного в ПС. |          |
|                       | Поле может отсутствовать в случае      |          |
|                       | неудачного платежа\                    |          |
|                       | Пример: 482.5                          |          |
+-----------------------+----------------------------------------+----------+
| pg_ps_amount          | Полная сумма (в валюте                 | string   |
|                       | pg_ps_currency), которую заплатил      |          |
|                       | покупатель с учетом всех комиссий.     |          |
|                       | Поле может отсутствовать в случае      |          |
|                       | неудачного платежа.\                   |          |
|                       | Пример: 500                            |          |
+-----------------------+----------------------------------------+----------+
| pg_ps_full_amount     | Полная сумма (в валюте                 | string   |
|                       | pg_ps_currency), которую заплатил      |          |
|                       | покупатель с учетом всех комиссий.     |          |
|                       | Поле может отсутствовать в случае      |          |
|                       | неудачного платежа\                    |          |
|                       | \                                      |          |
|                       | \                                      |          |
|                       | Пример: 500                            |          |
+-----------------------+----------------------------------------+----------+
| pg_ps_currency        | Валюта, в которой был произведен       | string   |
|                       | платеж в платежной системе. Поле может |          |
|                       | отсутствовать в случае неудачного      |          |
|                       | платежа\                               |          |
|                       | Пример: KZT                            |          |
+-----------------------+----------------------------------------+----------+
| pg_description        | Описание платежа\                      | string   |
|                       | Пример: Покупка в интернет магазине    |          |
|                       | Site.kz                                |          |
+-----------------------+----------------------------------------+----------+
| pg_result             | Результат платежа. 1 -- успех, 0 --    | integer  |
|                       | неудача.\                              |          |
|                       | Пример: 1                              |          |
+-----------------------+----------------------------------------+----------+
| pg_payment_date       | Дата и время совершения платежа в      | datetime |
|                       | формате YYYY-MM-DD HH:MM:SS.\          |          |
|                       | Пример: 2019-01-01 12:00:00            |          |
+-----------------------+----------------------------------------+----------+
| pg_can_reject         | 1 -- платеж можно откатить назад       | integer  |
|                       | (например, Банковские карты), 0 --     |          |
|                       | платеж безотзывный.\                   |          |
|                       | Пример: 1                              |          |
+-----------------------+----------------------------------------+----------+
| pg_user_phone         | Телефон покупателя (указанный при      | string   |
|                       | инициализации платежа)\                |          |
|                       | Пример: 7077777777777                  |          |
+-----------------------+----------------------------------------+----------+
| pg_user_contact_email | Email покупателя (указанный при        | string   |
|                       | инициализации платежа)\                |          |
|                       | Пример: mail@customer.kz               |          |
+-----------------------+----------------------------------------+----------+
| pg_testing_mode       | Тестовый режим. 1 - тестовый, 0 -      | integer  |
|                       | боевой.\                               |          |
|                       | Пример: 1                              |          |
+-----------------------+----------------------------------------+----------+
| pg_captured           | Передается только в случае успешной    | integer  |
|                       | оплаты банковской картой и показывает, |          |
|                       | был ли произведен клиринг в момент     |          |
|                       | авторизации (что зависит только от     |          |
|                       | настроек мерчанта). Если значение      |          |
|                       | этого поля равно 0, мерчант должен в   |          |
|                       | последующем дать команду на клиринг    |          |
|                       | (см. раздел Запрос на клиринг          |          |
|                       | транзакций по банковским картам) или   |          |
|                       | дождаться когда Hillstarpay сделает    |          |
|                       | это сам.\                              |          |
|                       | Пример: 0                              |          |
+-----------------------+----------------------------------------+----------+
| pg_card_id            | Опциональный параметр. ID карты для    | string   |
|                       | оплаты сохраненной картой              |          |
|                       | (Deprecated)\                          |          |
|                       | Пример: 1234                           |          |
+-----------------------+----------------------------------------+----------+
| pg_card_token         | Опциональный параметр. Токен карты для | string   |
|                       | оплаты сохраненной картой\             |          |
|                       | Пример:                                |          |
|                       | ef741cfc-f85e-41a0-84e6-2ba964912182   |          |
+-----------------------+----------------------------------------+----------+
| pg_card_pan           | Маскированный номер карты (часть цифр  | string   |
|                       | номера карты скрыты). Этот параметр    |          |
|                       | передается только в случае успешной    |          |
|                       | оплаты банковской картой\              |          |
|                       | Пример: 5483-18XX-XXXX-0293            |          |
+-----------------------+----------------------------------------+----------+
| Параметры мерчанта    | Все поля, переданные с веб-сайта       | string   |
|                       | мерчанта, не имеющие префикса pg\_     |          |
+-----------------------+----------------------------------------+----------+
| pg_salt               | Случайная строка\                      | string   |
|                       | Пример: some random string             |          |
+-----------------------+----------------------------------------+----------+
| pg_sig                | Подпись запроса                        | string   |
+-----------------------+----------------------------------------+----------+
| pg_discount_percent   | Информация о проценте скидки,          | string   |
|                       | отправляется если скидка присутствует\ |          |
|                       | Пример: 1.0                            |          |
+-----------------------+----------------------------------------+----------+
| pg_discount_amount    | Информация о сумме скидки,             | string   |
|                       | отправляется если скидка присутствует\ |          |
|                       | Пример: 5                              |          |
+-----------------------+----------------------------------------+----------+
| pg_payment_method     | Метод платежа\                         | string   |
|                       |                                        |          |
|                       |                                        |          |
|                       |   ------------------------------------ |          |
|                       |   **Значение**      **Метод платежа**  |          |
|                       |   ----------------- ------------------ |          |
|                       |   wallet            Электронные деньги |          |
|                       |                                        |          |
|                       |   internetbank      Интернет-банкинг   |          |
|                       |                                        |          |
|                       |   other             Терминалы          |          |
|                       |                                        |          |
|                       |   bankcard          Банковские карты   |          |
|                       |                                        |          |
|                       |   cash              Точки приема       |          |
|                       |                     платежей           |          |
|                       |                                        |          |
|                       |   mobile_commerce   Мобильная          |          |
|                       |                     коммерция          |          |
|                       |   ------------------------------------ |          |
|                       |                                        |          |
|                       | Пример: bankcard                       |          |
+-----------------------+----------------------------------------+----------+
| pg_card_exp           | Дата истечения срока карты\            | string   |
|                       | Пример: 03/23                          |          |
+-----------------------+----------------------------------------+----------+
| pg_card_owner         | Имя держателя карты\                   | string   |
|                       | Пример: Ivan Ivanov                    |          |
+-----------------------+----------------------------------------+----------+
| pg_card_brand         | Код бренда карты\                      | string   |
|                       | Пример: VI                             |          |
+-----------------------+----------------------------------------+----------+

 

 

 

**Возврат покупателя на сайт мерчанта**

 

После завершения платежа в online платежной системе, покупатель
перенаправляется на страницу мерчанта Success URL или Failure URL, в
зависимости от результата платежа. Перенаправление происходит методом
Success URL Method или Failure URL Method, указанным при инициализации
платежа.

Если при GET запросе Success URL или Failure URL уже содержат параметры
в query string, то дополнительные параметры pg_order_id, pg_payment_id и
пользовательские переменные мерчанта дописываются в конец query string.
мерчанта должен следить за тем, чтобы имена дополнительных параметров не
совпадали с именами уже имеющимися параметров.

Необходимо четко понимать разницу между Result URL и Success URL.

Result URL вызывается напрямую с сервера Hillstarpay, в то время как
Success URL вызывается браузером пользователя, когда Hillstarpay
перенаправляет пользователя обратно на сайт магазина. Неправильно
использовать Success URL как единственный способ узнать о завершении
оплаты, потому что пользователь может по разным причинам (например, при
разрыве связи) не дойти до Success URL после оплаты. Самый надежный
способ узнать о завершении платежа -- это реализовать Result URL,
который Hillstarpay обязуется вызывать повторно каждые полчаса в течение
2 часов после оплаты, если первая попытка по любым причинам не удалась.

 

**URL запроса**

POST {{success_url}} или {{failure_url}}

 

**Поля запроса:**

  --------------------------------------------------------------------
  **Название**           **Описание**                        **Тип**
  ---------------------- ----------------------------------- ---------
  pg_order_id            Идентификатор заказа в системе      string
                         мерчанта\                           
                         Пример: 123456789                   

  pg_payment_id          Внутренний идентификатор платежа в  integer
                         системе Hillstarpay\                
                         Пример: 12345                       

  Параметры мерчанта     Все поля, переданные с веб-сайта    string
                         мерчанта, не имеющие префикса pg\_  

  pg_salt                Случайная строка\                   string
                         Пример: some random string          

  pg_sig                 Подпись запроса                     string

  pg_error_code          Код ошибки. В случае ошибки         string
                         параметр будет отправляться на      
                         pg_failure_url\                     
                         Пример: 1000                        

  pg_error_description   Описание ошибки. В случае ошибки    string
                         параметр будет отправляться на      
                         pg_failure_url\                     
                         Пример: Внутреняя ошибка сервиса    
  --------------------------------------------------------------------

 

**URL запроса**

POST {{check_url}}

 

**Поля запроса:**

  ------------------------------------------------------------------
  **Название**        **Описание**                        **Тип**
  ------------------- ----------------------------------- ----------
  pg_order_id         Идентификатор заказа в системе      string
                      мерчанта\                           
                      Пример: 123456789                   

  pg_payment_id       Внутренний идентификатор платежа в  integer
                      системе Hillstarpay\                
                      Пример: 12345                       

  pg_amount           Сумма выставленного счета (в валюте number
                      pg_currency), совпадает с pg_amount 
                      в момент инициализации платежа.\    
                      Пример: 10                          

  pg_currency         Валюта выставленного счета,         string
                      совпадает с pg_currency в момент    
                      инициализации платежа.\             
                      Пример: KZT                         

  pg_ps_currency      Валюта, в которой был произведен    string
                      платеж в платежной системе. Поле    
                      может отсутствовать в случае        
                      неудачного платежа\                 
                      Пример: KZT                         

  pg_ps_amount        Сумма счета (в валюте               number
                      pg_ps_currency), выставленного в    
                      платежной системе.\                 
                      Пример: 5                           

  pg_ps_full_amount   Полная сумма (в валюте              number
                      pg_ps_currency), которую заплатит   
                      покупатель с учетом всех комиссий.\ 
                      Пример: 5                           

  Параметры мерчанта  Все поля, переданные с веб-сайта    string
                      мерчанта, не имеющие префикса pg\_  

  pg_salt             Случайная строка\                   string
                      Пример: some random string          

  pg_sig              Подпись запроса                     string\
                                                          \
                                                           
  ------------------------------------------------------------------

** **

** **

** **

**Запрос на result_url магазина. Результат платежа**

 

Запрос на result url приходит методом POST, с заголовком Сontent-type:
application/json и телом запроса\
Result URL на стороне мерчанта должен быть общедоступным, без
авторизации.

 

{

\"id\": 12345,

\"status\": {

\"code\": \"success\"

},

\"order\": 1234,

\"amount\": \"100.00\",

\"refund_amount\": \"0.00\",

\"currency\": \"KZT\",

\"description\": \"Описание заказа\",

\"payment_system\": \"WEBKZT\",

\"expires_at\": \"2022-01-18T05:58:58Z\",

\"created_at\": \"2022-01-17T11:58:58Z\",

\"updated_at\": \"2022-01-17T11:59:07Z\",

\"param1\": null,

\"param2\": null,

\"param3\": null,

\"options\": {

\"callbacks\": {

\"result_url\": \"\",

\"check_url\": \"\"

},

\"user\": {

\"email\":
\"[widget@hillstarpay.com\",](mailto:widget@greenleavespay.kz)

\"phone\": \"77\"

},

\"receipt_positions\": null

},

\"salt\": \"EitR7ZYZvhpioeCU\",

\"sig\": \"05e72b0137c52c1e941c627f42cb1f39\"

}

 

Мерчант должен ответить на запрос следующим текстом:

 

{\"status\": \"ok\"}

 

 

 

**Балансом мобильного**

 

 

 

Hillstarpay предлагает возможность оплачивать заказ/услугу с баланса
мобильного телефона, если мобильный оператор плательщика поддерживает
данную возможность. Доступные мобильные операторы:

Tele2\
Altel\
Beeline\
Activ\
Kcell

 

**Инициализация платежа**

 

Запрос:

 

curl \--location \--request POST
\'[https://api.hillstarpay.com/init_payment.php\'](https://api.greenleavespay.kz/init_payment.php)
\\

\--form \'pg_order_id=23\' \\

\--form \'pg_merchant_id={{Hillstarpay_merchant_id}}\' \\

\--form \'pg_amount=25\' \\

\--form \'pg_description=test\' \\

\--form \'pg_salt=molbulak\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\' \\

\--form \'pg_payment_method=mobile_commerce\'

\# Пример подписи:

\'init_payment.php;25;test;{{Hillstarpay_merchant_id}};23;KZT;molbulak;{{secret_key}}\'

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_payment_id\>4567788\</pg_payment_id\>

\<pg_redirect_url\>https://api.hillstarpay.com/pay.html?customer=498333170d6a895148c57c53ffb18287\</pg_redirect_url\>

\<pg_redirect_url_type\>need data\</pg_redirect_url_type\>

\<pg_salt\>bdwLavL9lg6It91b\</pg_salt\>

\<pg_sig\>709633e91387c56ac6fb7cb33d1e07d8\</pg_sig\>

\</response\>

 

 

При прямой передаче данных от мерчанта в Hillstarpay мерчант должен
посылать данные на init_payment.php.

Можно передавать произвольные дополнительные параметры, имена которых не
начинаются на pg\_. Все эти параметры будут переданы на pg_check_url и
pg_result_url.

Имена дополнительных параметров мерчанта должны быть уникальны.

После получение параметра pg_redirect_url пользователя перенаправляют на
платежную страницу где плательщик завершает платеж.

В случае успеха пользователь будет перенаправлен на страницу оплаты.

В случае если мерчантом переданы не все параметры, необходимые для
создания платежной транзакции (платежная система, телефон пользователя и
параметры, необходимые для выбранной платежной системы), они
запрашиваются у пользователя на сайте hillstarpay.com.

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_amount\' =\> 10,

\'pg_salt\' =\> \'some random string\',

\'pg_order_id\'=\> \'00102\',

\'pg_description\' =\> \'Ticket\',

\'pg_result_url\' =\> \'[http://site.kz/result\'](http://site.kz/result)

\];

// \$request\[\'pg_testing_mode\'\] = 1; //add this parameter to request
for testing payments

//if you pass any of your parameters, which you want to get back after
the payment, then add them. For example:

// \$request\[\'client_name\'\] = \'My Name\';

// \$request\[\'client_address\'\] = \'Earth Planet\';

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'init_payment.php\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

**URL запроса**

POST
[https://api.hillstarpay.com/init_payment.php](https://api.tezpayments.kg/init_payment.php)

 

**Поля запроса:**

  --------------------------------------------------------------------------
  **Название**                        **Описание**                 **Тип**
  ----------------------------------- ---------------------------- ---------
  pg_order_id\                        Идентификатор платежа в      string
  required                            системе мерчанта.            
                                      Рекомендуется поддерживать   
                                      уникальность этого поля.\    
                                      Пример: 00102                

  pg_merchant_id\                     Идентификатор мерчанта в     integer
  required                            Hillstarpay. Выдается при    
                                      подключении.                 

  pg_amount\                          Сумма платежа в валюте       number
  required                            pg_currency.\                
                                      Минимум 0.01\                
                                      Пример: 10                   

  pg_description\                     Описание товара или услуги.  string
  required                            Отображается покупателю в    
                                      процессе платежа.\           
                                      Пример: Ticket               

  pg_salt\                            Случайная строка\            string
  required                            Пример: some random string   

  pg_sig\                             Подпись запроса              string
  required                                                         

  pg_currency                         Валюта, в которой указана    string
                                      сумма. KZT, USD, EUR. В      
                                      случае выбора покупателем    
                                      способа платежа в другой     
                                      валюте, производится         
                                      пересчет по курсу НБ на день 
                                      платежа. См. в разделе       
                                      Справочник валют\            
                                      Пример: KZT                  

  pg_check_url                        URL для проверки возможности string
                                      платежа. Вызывается перед    
                                      платежом, если платежная     
                                      система предоставляет такую  
                                      возможность. Если параметр   
                                      не указан, то берется из     
                                      настроек мерчанта. Если      
                                      параметр установлен равным   
                                      пустой строке, то проверка   
                                      возможности платежа не       
                                      производится.                

  pg_result_url                       URL для сообщения о          string
                                      результате платежа.          
                                      Вызывается после платежа в   
                                      случае успеха или неудачи.   
                                      Если параметр не указан, то  
                                      берется из настроек          
                                      мерчанта. Если параметр      
                                      установлен равным пустой     
                                      строке, то Hillstarpay не    
                                      сообщает мерчанту о          
                                      результате платежа.          

  pg_request_method                   GET, POST или XML -- метод   string
                                      вызова скриптов мерчанта     
                                      Check URL, Result URL, для   
                                      передачи информации от       
                                      платежного гейта.\           
                                      Пример: POST                 

  pg_success_url                      url, на который отправляется string
                                      пользователь в случае        
                                      успешного платежа (только    
                                      для online систем)           

  pg_failure_url                      url, на который отправляется string
                                      пользователь в случае        
                                      неуспешного платежа (только  
                                      для online систем)           

  pg_success_url_method               GET -- кнопка, которая       string
                                      сабмитится методом GET. POST 
                                      -- кнопка, которая           
                                      сабмитится методом POST.     
                                      Если выбран метод GET или    
                                      POST, то страница с          
                                      подтверждением оплаты        
                                      показывается пользователю на 
                                      сайте hillstarpay.com, и     
                                      предлагается нажать кнопку,  
                                      чтобы вернуться на сайт      
                                      мерчанта.\                   
                                      Пример: GET                  

  pg_failure_url_method               GET -- кнопка, которая       string
                                      сабмитится методом GET. POST 
                                      -- кнопка, которая           
                                      сабмитится методом POST.     
                                      Если выбран метод GET или    
                                      POST, то страница с          
                                      сообщением о неудавшейся     
                                      оплате показывается          
                                      пользователю на сайте        
                                      hillstarpay.com, и           
                                      предлагается нажать кнопку,  
                                      чтобы вернуться на сайт      
                                      мерчанта.\                   
                                      Пример: GET                  

  pg_site_url                         URL сайта мерчанта для       string
                                      показа покупателю ссылки, по 
                                      которой он может вернуться   
                                      на сайт мерчанта после       
                                      создания счета. Применяется  
                                      для offline ПС (наличные).\  
                                      Пример:                      
                                      <http://site.kz/return>      

  pg_lifetime                         Default: \"86400\"\          integer
                                      Время (в секундах) в течение 
                                      которого платеж должен быть  
                                      завершен, в противном случае 
                                      заказ при проведении платежа 
                                      Hillstarpay откажет          
                                      платежной системе в          
                                      проведении. Этот параметр    
                                      контролируется Hillstarpay,  
                                      а также, если платежная      
                                      система поддерживает такую   
                                      возможность, и платежной     
                                      системой. Минимально         
                                      допустимое значение: 300     
                                      секунд (5 минут).            
                                      Максимально допустимое       
                                      значение: 604800 секунд (7   
                                      суток). В случае выхода за   
                                      пограничные значения будет   
                                      присвоено минимальное или    
                                      максимальное значение,       
                                      соответственно.\             
                                      Пример: 86400                

  pg_user_phone                       Телефон пользователя         string
                                      (начиная с кода страны),     
                                      необходим для идентификации  
                                      покупателя. Если не указан,  
                                      выбор будет предложен        
                                      пользователю на сайте        
                                      платежного гейта.\           
                                      Пример: 77777777777          

  pg_user_contact_email               Контактный адрес электронной string
                                      почты пользователя. Если     
                                      указан, на этот адрес будут  
                                      высылаться уведомления об    
                                      изменении статуса            
                                      транзакции.\                 
                                      Пример: mail@customer.kz     

  pg_user_ip                          IP-адрес клиента. Необходим  string
                                      для разбора спорных ситуаций 
                                      в случае подозрения на       
                                      мошенничество. Параметр      
                                      можно не передавать при      
                                      передаче информации через    
                                      браузер пользователя, в этом 
                                      случае будет записан тот IP, 
                                      с которого пользователь      
                                      перешёл на страницу          
                                      инициализации платежа.\      
                                      Пример: 127.0.0.1            

  pg_language                         Язык платежных страниц на    string
                                      сайте Hillstarpay и (если    
                                      возможно) платежных систем.  
                                      \"en\", \"ru\"\              
                                      Пример: ru                   

  pg_testing_mode                     Создание платежа в тестовом  integer
                                      режиме.\                     
                                      Пример: 1                    

  pg_user_id                          ID пользователя в системе    string
                                      мерчанта.\                   
                                      Пример: No65GFR755789T,      
                                      25642588                     

  pg_param1                           Дополнительный параметр 1\   string
                                      Пример: Дополнительная       
                                      информация                   

  pg_param2                           Дополнительный параметр 2\   string
                                      Пример: Дополнительная       
                                      информация                   

  pg_param3                           Дополнительный параметр 3\   string
                                      Пример: Дополнительная       
                                      информация                   

  pg_payment_method                   Значение - Метод платежа\    string
                                      mobile_commerce - Мобильная  
                                      коммерция\                   
                                      \                            
                                      Пример: mobile_commerce      

  pg_generate_qr                      В случае, если вы хотите     boolean
                                      получать QR код со ссылкой   
                                      на платежную форму           
                                      Hillstarpay в формате        
                                      base64, в параметре          
                                      pg_generate_qr необходимо    
                                      отправить «1»                

  pg_commission_discount              В случае, если вы хотите     boolean
                                      использовать скидку на       
                                      комиссию, то необходимо      
                                      отправить 1. Скидка работает 
                                      только на комиссию сверху.   
                                      Для использования метода     
                                      обратитесь к персональному   
                                      менеджеру                    

  pg_commission_discount_fix          Для использования            number
                                      фиксированной суммы скидки   

  pg_commission_discount_percentage   Для использования процентной number
                                      скидки                       
  --------------------------------------------------------------------------

** **

** **

**Параметры ответа:**

 

+----------------------+------------------------------------+---------+
| **Название**         | **Описание**                       | **Тип** |
+======================+====================================+=========+
| pg_status            | Показывает результат выполнения    | string  |
|                      | запроса                            |         |
|                      |                                    |         |
|                      |   -----------------------------    |         |
|                      |   Статус   Описание                |         |
|                      |   -------- --------------------    |         |
|                      |   ok       Запрос прошел           |         |
|                      |            успешно                 |         |
|                      |                                    |         |
|                      |   error    Запрос прошел с         |         |
|                      |            ошибкой                 |         |
|                      |   -----------------------------    |         |
+----------------------+------------------------------------+---------+
| pg_payment_id        | Уникальный идентификатор платежной | integer |
|                      | транзакции в Hillstarpay. Служит   |         |
|                      | ключом для всей дальнейшей работы  |         |
|                      | с транзакцией                      |         |
+----------------------+------------------------------------+---------+
| pg_redirect_url      | URL для перенаправления            | string  |
|                      | пользователя. Может быть как на    |         |
|                      | сайте hillstarpay.com, так и на    |         |
|                      | сайте платежной системы            |         |
+----------------------+------------------------------------+---------+
| pg_redirect_url_type | Тип страницы, на которую           | string  |
|                      | происходит перенаправление.        |         |
|                      | Возможные значения:\               |         |
|                      | need data -- диалог с покупателем  |         |
|                      | с целью уточнения параметров:      |         |
|                      | платежной системы, номера          |         |
|                      | телефона, обязательных для данной  |         |
|                      | платежной системы параметров;\     |         |
|                      | payment system -- страница сайта   |         |
|                      | платежной системы либо страница с  |         |
|                      | инструкциями оплаты через данную   |         |
|                      | платежную систему. Страница с      |         |
|                      | инструкциями может располагаться   |         |
|                      | как на сайте hillstarpay.com, так  |         |
|                      | и на сайте мерчанта.\              |         |
|                      | \                                  |         |
|                      | В случае получения мерчантом       |         |
|                      | ответа с                           |         |
|                      | pg_redirect_url_type="need data",  |         |
|                      | мерчант может не перенаправлять    |         |
|                      | покупателя по полученному URL, а   |         |
|                      | уточнить недостающие параметры у   |         |
|                      | себя на сайте. В этом случае после |         |
|                      | уточнения параметров и повторного  |         |
|                      | запроса на создание платежной      |         |
|                      | транзакции будет создана новая     |         |
|                      | транзакция                         |         |
+----------------------+------------------------------------+---------+
| pg_redirect_qr       | URL для перенаправления            | string  |
|                      | пользователя в виде QR. Передается |         |
|                      | в формате base64                   |         |
+----------------------+------------------------------------+---------+
| pg_salt              | Случайная строка                   | string  |
+----------------------+------------------------------------+---------+
| pg_sig               | Подпись запроса                    | string  |
+----------------------+------------------------------------+---------+

 

 

 

**Оплата с мобильного**

 

Платёж в большинстве случаев проходит OTP-верификацию. Т.е. для
совершения платежа требуется подтверждение. Но по особым договоренностям
есть возможность отключить OTP-верификацию.

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_payment_id\' =\> 12345,

\'pg_abonent_phone\' =\> 77077777777,

\'pg_payment_system_code\' =\> \'ALTELKZT\',

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'pay\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

Если в ответе pg_status равен need_approve Hillstarpay отправит SMS
сообщение на номер указанный в pg_abonent_phone с OTP кодом. Для
продолжения мерчанту необходимо запросить данный код у плательщика.

 

**URL запроса**

POST
[https://api.hillstarpay.com/mfs/pay](https://api.tezpayments.kg/mfs/pay)

 

**Поля запроса:**

  --------------------------------------------------------------------
  **Название**             **Описание**                      **Тип**
  ------------------------ --------------------------------- ---------
  pg_merchant_id\          Идентификатор мерчанта в системе  string
  required                 Hillstarpay.                      

  pg_payment_id\           Внутренний идентификатор платежа  integer
  required                 в системе Hillstarpay\            
                           Пример: 12345                     

  pg_abonent_phone\        Телефон покупателя с баланса      string
  required                 которого снимутся деньги.\        
                           Пример: 77077777777               

  pg_payment_system_code   Уникальный код мобильного         string
                           оператора. Enum:\"TELE2KZT\"      
                           \"ALTELKZT\" \"BEELINEKZT\"       
                           \"KCELLKZT\" \"ACTIVKZT\"\        
                           Пример: ALTELKZT                  

  pg_salt\                 Случайная строка\                 string
  required                 Пример: some random string        

  pg_sig\                  Подпись запроса                   string
  required                                                   
  --------------------------------------------------------------------

** **

** **

**Параметры ответа:**

 

+----------------+-----------------------------------------+---------+
| **Название**   | **Описание**                            | **Тип** |
+================+=========================================+=========+
| pg_status      | Показывает результат выполнения запроса | string  |
|                |                                         |         |
|                |   ------------------------------------- |         |
|                |   Статус         Описание               |         |
|                |   -------------- ---------------------- |         |
|                |   ok             Списание прошло        |         |
|                |                  успешно                |         |
|                |                                         |         |
|                |   need_approve   Необходимо             |         |
|                |                  подтверждение          |         |
|                |                                         |         |
|                |   error          Ошибка списания        |         |
|                |   ------------------------------------- |         |
+----------------+-----------------------------------------+---------+
| pg_payment_id  | Уникальный идентификатор платежной      | integer |
|                | транзакции в Hillstarpay. Служит ключом |         |
|                | для всей дальнейшей работы с            |         |
|                | транзакцией                             |         |
+----------------+-----------------------------------------+---------+

 

 

 

**Подтверждение платежа**

 

 

Для подтверждение платежа отправляется следующий запрос:

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_payment_id\' =\> 12345,

\'pg_approval_code\' =\> \'077587\',

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'approve\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

**URL запроса**

POST
[https://api.hillstarpay.com/mfs/approve](https://api.tezpayments.kg/mfs/approve)

 

**Поля запроса:**

 

  -----------------------------------------------------------------
  **Название**        **Описание**                        **Тип**
  ------------------- ----------------------------------- ---------
  pg_merchant_id\     Идентификатор магазина в системе    integer
  required            Hillstarpay.                        

  pg_payment_id\      Внутренний идентификатор платежа в  integer
  required            системе Hillstarpay.\               
                      Пример: 12345                       

  pg_approval_code\   Одноразовый OTP код отправленный    string
  required            SMS сообщением на номер             
                      плательщика.\                       
                      Пример: 077587                      

  pg_salt\            Случайная строка\                   string
  required            Пример: some random string          

  pg_sig\             Подпись запроса                     string
  required                                                
  -----------------------------------------------------------------

** **

**Параметры ответа:**

 

+-----------------+------------------------------------+---------+
| **Название**    | **Описание**                       | **Тип** |
+=================+====================================+=========+
| pg_status       | Показывает результат выполнения    | string  |
|                 | запроса\                           |         |
|                 |                                    |         |
|                 |                                    |         |
|                 |   -------------------------------- |         |
|                 |   Статус    Описание               |         |
|                 |   --------- ---------------------- |         |
|                 |   ok        Списание прошло        |         |
|                 |             успешно                |         |
|                 |                                    |         |
|                 |   process   Списание в процессе.   |         |
|                 |                                    |         |
|                 |   error     Ошибка списания        |         |
|                 |   -------------------------------- |         |
+-----------------+------------------------------------+---------+
| pg_payment_id   | Уникальный идентификатор платежной | integer |
|                 | транзакции в Hillstarpay. Служит   |         |
|                 | ключом для всей дальнейшей работы  |         |
|                 | с транзакцией                      |         |
+-----------------+------------------------------------+---------+

 

**Запрос на повторную отправку SMS кода**

 

Мерчант может еще раз запрашивать повторную отправку SMS кода.

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_payment_id\' =\> 12345,

\'pg_abonent_phone\' =\> 77077777777,

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'resend_otp\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

 

**URL запроса**

POST
[https://api.hillstarpay.com/mfs/resend_otp](https://api.tezpayments.kg/mfs/resend_otp)

 

**Поля запроса:**

 

  -----------------------------------------------------------------
  **Название**        **Описание**                        **Тип**
  ------------------- ----------------------------------- ---------
  pg_merchant_id\     Идентификатор магазина в системе    integer
  required            Hillstarpay.                        

  pg_payment_id\      Идентификатор платежа в системе     integer
  required            Hillstarpay.\                       
                      Пример: 12345                       

  pg_abonent_phone\   Телефон покупателя с баланса        string
  required            которого снимутся деньги.\          
                      Пример: 77077777777                 

  pg_salt\            Случайная строка\                   string
  required            Пример: some random string          

  pg_sig\             Подпись запроса                     string
  required                                                
  -----------------------------------------------------------------

 

**Запрос на check_url магазина. Проверка возможности совершить платеж.**

 

Пример положительного ответа магазина

 

Запрос:

 

curl \--location \--request POST \'{{check_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_amount=10\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_ps_amount=5\' \\

\--form \'pg_ps_full_amount=5\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\'

 

 

Ответ

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_description\>Платеж разрешен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

Пример отрицательного ответа магазина

 

Запрос

 

curl \--location \--request POST \'{{check_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_amount=10\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_ps_amount=5\' \\

\--form \'pg_ps_full_amount=5\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\'

 

 

Ответ

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>rejected\</pg_status\>

\<pg_description\>Платеж не разрешен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

 

Для использования данного запроса Вам следует обратиться к своему
менеджеру

Перед тем как принять деньги от покупателя по счету, платежный гейт
может вызвать скрипт мерчанта Check URL с помощью метода Request Method.

Check URL на стороне мерчанта должен быть общедоступным, без
авторизации.

Hillstarpay передает информацию о номере и свойствах заказа и ожидает
ответа. Отсутствие ответа за указанное время воспринимается как отказ от
платежа.

Вызов скрипта Check URL происходит только в случае, если такая опция
была включена в настройках мерчанта.

Ответ на check_url от мерчанта

Если Check URL определен пустым в момент инициализции платежа или не
указан в момент инициализации платежа, а в настройках мерчанта
установлен пустым, то шаг проверки возможности совершить платеж
пропускается и считается, что мерчант согласен принять платеж.

- В случае если мерчант подтверждает готовность заказа и правильность
  суммы, он должен ответить в виде XML со статусом ok.

- В случае отказа от платежа rejected.

- error - ошибка в интерпретации данных.

 

 

**URL запроса**

POST {{check_url}}

 

**Поля запроса:**

 

  ------------------------------------------------------------------
  **Название**        **Описание**                        **Тип**
  ------------------- ----------------------------------- ----------
  pg_order_id         Идентификатор заказа в системе      string
                      мерчант\                            
                      Пример: 123456789                   

  pg_payment_id       Внутренний идентификатор платежа в  integer
                      системе Hillstarpay.\               
                      Пример: 12345                       

  pg_amount           Сумма выставленного счета (в валюте number
                      pg_currency), совпадает с pg_amount 
                      в момент инициализации платежа.\    
                      Пример: 10                          

  pg_currency         Валюта выставленного счета,         string
                      совпадает с pg_currency в момент    
                      инициализации платежа.\             
                      Пример: KZT                         

  pg_ps_currency      Валюта, в которой был произведен    string
                      платеж в платежной системе. Поле    
                      может отсутствовать в случае        
                      неудачного платежа\                 
                      Пример: KZT                         

  pg_ps_amount        Сумма счета (в валюте               number
                      pg_ps_currency), выставленного в    
                      платежной системе.\                 
                      Пример: 5                           

  pg_ps_full_amount   Полная сумма (в валюте              number
                      pg_ps_currency), которую заплатит   
                      покупатель с учетом всех комиссий.\ 
                      Пример: 5                           

  Параметры мерчанта  Все поля, переданные с веб-сайта    string
                      мерчант, не имеющие префикса pg\_   

  pg_salt             Случайная строка\                   string
                      Пример: some random string          

  pg_sig              Подпись запроса                     string
  ------------------------------------------------------------------

 

**Запрос на result_url магазина. Результат платежа**

 

Пример положительного ответа магазина

 

Запрос:

 

curl \--location \--request POST \'{{result_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_description=Покупка в интернет магазине Site.kz\' \\

\--form \'pg_result=1\' \\

\--form \'pg_payment_date=2019-01-01 12:00:00\' \\

\--form \'pg_can_reject=1\' \\

\--form \'pg_user_phone=7077777777777\' \\

\--form \'[pg_user_contact_email=mail@customer.kz\'
\\](mailto:pg_user_contact_email=mail@customer.kz)

\--form \'pg_need_email_notification=1\' \\

\--form \'pg_testing_mode=1\' \\

\--form \'pg_captured=0\' \\

\--form \'pg_card_pan=5483-18XX-XXXX-0293\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\' \\

\--form \'pg_payment_method=bankcard\'

 

 

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_description\>Заказ оплачен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

 

Пример отрицательного ответа магазина

 

Запрос:

 

curl \--location \--request POST \'{{result_url}}\' \\

\--form \'pg_order_id=123456789\' \\

\--form \'pg_payment_id=12345\' \\

\--form \'pg_currency=KZT\' \\

\--form \'pg_ps_currency=KZT\' \\

\--form \'pg_description=Покупка в интернет магазине Site.kz\' \\

\--form \'pg_result=1\' \\

\--form \'pg_payment_date=2019-01-01 12:00:00\' \\

\--form \'pg_can_reject=1\' \\

\--form \'pg_user_phone=7077777777777\' \\

\--form \'[pg_user_contact_email=mail@customer.kz\'
\\](mailto:pg_user_contact_email=mail@customer.kz)

\--form \'pg_need_email_notification=1\' \\

\--form \'pg_testing_mode=1\' \\

\--form \'pg_captured=0\' \\

\--form \'pg_card_pan=5483-18XX-XXXX-0293\' \\

\--form \'Параметры мерчанта=\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\' \\

\--form \'pg_payment_method=bankcard\'

 

 

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>rejected\</pg_status\>

\<pg_description\>Платеж отменен\</pg_description\>

\<pg_salt\>random string\</pg_salt\>

\<pg_sig\>ksdjrimzjedkljsujjemnjsuj\</pg_sig\>

\</response\>

 

 

После приема оплаты от клиента или при невозможности совершить платеж
Hillstarpay вызывает Result URL магазина и передает на него методом
Request Method информацию о результате платежа.

При получении данного запроса мерчант должен произвести необходимые
действия для передачи товара или услуги покупателю, в случае если платеж
был успешным. Если pg_can_reject равно 1 и мерчант не может принять
платеж (например, бронь на билеты истекла), он обязан ответить со
статусом rejected, и Hillstarpay отзовет платеж. В этом случае поле
pg_description из ответа мерчанта показывается пользователю как причина
отказа.

Result URL на стороне мерчанта должен быть общедоступным, без
авторизации.

Если сервер мерчанта недоступен в момент вызова Result URL или ответ от
сервера был не со статусом 200, Hillstarpay будет предпринимать
повторные попытки его вызвать каждые полчаса в течение 2 часов, даже
если время жизни счета pg_lifetime истечет.

Если первая попытка вызова Result URL оказалась неуспешной, то платеж не
отменяется, и в последующих вызовах Result URL не позволяет магазину
отказаться от платежа.

Магазин должен быть готов к тому, что Result URL будет вызван повторно
для одного и того же платежа. Ответы на повторные вызовы должны
совпадать с первоначальным ответом, даже если время жизни транзакции
pg_lifetime истекло.

 

Ответ на result_url от мерчанта

Статус rejected может быть возвращен мерчантом только в случае, когда во
входящем запросе от гейта был указан параметр pg_can_reject равный 1, в
противном случае, вне зависимости от ответа мерчанта, платеж будет
считаться совершенным. Если мерчант отказался от платежа (ответил
rejected), покупатель перенаправляется на Failure URL, иначе -- на
Success URL.

- ok - платеж принят

- rejected - отказ от платежа случае если pg_can_reject равен 1

- error - ошибка в интерпретации данных

** **

 

 

** **

**URL запроса**

POST {{result_url}}

 

**Поля запроса:**

 

+-----------------------+-----------------------------------------+----------+
| **Название**          | **Описание**                            | **Тип**  |
+=======================+=========================================+==========+
| pg_order_id           | Идентификатор заказа в системе          | string   |
|                       | мерчанта\                               |          |
|                       | Пример: 123456789                       |          |
+-----------------------+-----------------------------------------+----------+
| pg_payment_id         | Внутренний идентификатор платежа в      | integer  |
|                       | системе Hillstarpay.\                   |          |
|                       | Пример: 12345                           |          |
+-----------------------+-----------------------------------------+----------+
| pg_currency           | Валюта выставленного счета, совпадает с | string   |
|                       | pg_currency в момент инициализации      |          |
|                       | платежа.\                               |          |
|                       | Пример: KZT                             |          |
+-----------------------+-----------------------------------------+----------+
| pg_ps_currency        | Валюта, в которой был произведен платеж | string   |
|                       | в платежной системе. Поле может         |          |
|                       | отсутствовать в случае неудачного       |          |
|                       | платежа\                                |          |
|                       | Пример: KZT                             |          |
+-----------------------+-----------------------------------------+----------+
| pg_description        | Описание платежа\                       | string   |
|                       | Пример: Покупка в интернет магазине     |          |
|                       | Site.kz                                 |          |
+-----------------------+-----------------------------------------+----------+
| pg_result             | Результат платежа. 1 -- успех, 0 --     | integer  |
|                       | неудача.\                               |          |
|                       | Пример: 1                               |          |
+-----------------------+-----------------------------------------+----------+
| pg_payment_date       | Дата и время совершения платежа в       | datetime |
|                       | формате YYYY-MM-DD HH:MM:SS.\           |          |
|                       | Пример: 2019-01-01 12:00:00             |          |
+-----------------------+-----------------------------------------+----------+
| pg_can_reject         | 1 -- платеж можно откатить назад        | integer  |
|                       | (например, Банковские карты), 0 --      |          |
|                       | платеж безотзывный.\                    |          |
|                       | Пример: 1                               |          |
+-----------------------+-----------------------------------------+----------+
| pg_user_phone         | Телефон покупателя (указанный при       | string   |
|                       | инициализации платежа)\                 |          |
|                       | Пример: 7077777777777                   |          |
+-----------------------+-----------------------------------------+----------+
| pg_user_contact_email | Email покупателя (указанный при         | string   |
|                       | инициализации платежа)\                 |          |
|                       | Пример: mail@customer.kz                |          |
+-----------------------+-----------------------------------------+----------+
| pg_testing_mode       | Тестовый режим. 1 - тестовый, 0 -       | integer  |
|                       | боевой.\                                |          |
|                       | Пример: 1                               |          |
+-----------------------+-----------------------------------------+----------+
| pg_captured           | Передается только в случае успешной     | integer  |
|                       | оплаты банковской картой и показывает,  |          |
|                       | был ли произведен клиринг в момент      |          |
|                       | авторизации (что зависит только от      |          |
|                       | настроек мерчанта). Если значение этого |          |
|                       | поля равно 0, мерчант должен в          |          |
|                       | последующем дать команду на клиринг     |          |
|                       | (см. раздел Запрос на клиринг           |          |
|                       | транзакций по банковским картам) или    |          |
|                       | дождаться когда Hillstarpay сделает это |          |
|                       | сам.\                                   |          |
|                       | Пример: 0                               |          |
+-----------------------+-----------------------------------------+----------+
| pg_card_pan           | Маскированный номер карты (часть цифр   | string   |
|                       | номера карты скрыты). Этот параметр     |          |
|                       | передается только в случае успешной     |          |
|                       | оплаты банковской картой\               |          |
|                       | Пример: 5483-18XX-XXXX-0293             |          |
+-----------------------+-----------------------------------------+----------+
| Параметры мерчанта    | Все поля, переданные с веб-сайта        | string   |
|                       | мерчант, не имеющие префикса pg\_       |          |
+-----------------------+-----------------------------------------+----------+
| pg_salt               | Случайная строка\                       | string   |
|                       | Пример: some random string              |          |
+-----------------------+-----------------------------------------+----------+
| pg_sig                | Подпись запроса                         | string   |
+-----------------------+-----------------------------------------+----------+
| pg_payment_method     | Метод платежа\                          |          |
|                       |                                         |          |
|                       |                                         |          |
|                       |   ------------------------------------- |          |
|                       |   **Значение**      **Метод платежа**   |          |
|                       |   ----------------- ------------------- |          |
|                       |   wallet            Электронные деньги  |          |
|                       |                                         |          |
|                       |   internetbank      Интернет-банкинг    |          |
|                       |                                         |          |
|                       |   other             Терминалы           |          |
|                       |                                         |          |
|                       |   bankcard          Банковские карты    |          |
|                       |                                         |          |
|                       |   cash              Точки приема        |          |
|                       |                     платежей            |          |
|                       |                                         |          |
|                       |   mobile_commerce   Мобильная коммерция |          |
|                       |   ------------------------------------- |          |
|                       |                                         |          |
|                       | Пример: bankcard                        |          |
+-----------------------+-----------------------------------------+----------+

 

 

 

**Получение статуса платежа**

 

 

Запрос:

 

curl \--location \--request POST
\'[https://api.hillstarpay.com/get_status3.php](https://api.tezpayments.kg/get_status3.php)\'
\\

\--form \'pg_merchant_id={{Hillstarpaymerchant_id}}\' \\

\--form \'pg_payment_id=123456789\' \\

\--form \'pg_order_id=00102\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\'

\# Пример подписи:

\'get_status.php;{{Hillstarpay_merchant_id}};00102;123456789;some random
string;{{secret_key}}\'

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_payment_id\>123456789\</pg_payment_id\>

\<pg_can_reject\>1\</pg_can_reject\>

\<pg_payment_method\>bankcard\</pg_payment_method\>

\<pg_amount\>10\</pg_amount\>

\<pg_currency\>KZT\</pg_currency\>

\<pg_payment_status\>success\</pg_payment_status\>

\<pg_clearing_amount\>10\</pg_clearing_amount\>

\<pg_reference\>123456789\</pg_reference\>

\<pg_card_name\>Card Holder\</pg_card_name\>

\<pg_card_pan\>5483-18XX-XXXX-0293\</pg_card_pan\>

\<pg_card_token\>ef741cfc-f85e-41a0-84e6-2ba964912182\</pg_card_token\>

\<pg_refund_payments\>

\<pg_refund_payment\>

\<pg_payment_id\>123456789\</pg_payment_id\>

\<pg_payment_status\>success\</pg_payment_status\>

\<pg_amount\>-10\</pg_amount\>

\<pg_payment_date\>2023-05-31 16:26:36\</pg_payment_date\>

\<pg_reference\>123456789\</pg_reference\>

\</pg_refund_payment\>

\</pg_refund_payments\>

\<pg_refund_amount\>-10\</pg_refund_amount\>

\<pg_captured\>1\</pg_captured\>

\<pg_create_date\>2023-05-31 16:24:20\</pg_create_date\>

\<pg_salt\>some random string\</pg_salt\>

\<pg_sig\>your_signature\</pg_sig\>

\</response\>

 

 

Мерчант может запрашивать Hillstarpay статус любого платежа,
инициированного магазином. Это может быть полезно, например, в случае
если вызов Result URL не был получен мерчантом из-за временного сбоя
связи, а покупатель уже был передан на Success URL, однако статус
транзакции мерчанту еще не известен.

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpayy_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_payment_id\' =\> 123456789,

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'get_status3.php\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

**URL запроса**

POST
[https://api.hillstarpay.com/get_status3.php](https://api.tezpayments.kg/get_status3.php)

 

**Поля запроса:**

  -----------------------------------------------------------------
  **Название**       **Описание**                         **Тип**
  ------------------ ------------------------------------ ---------
  pg_merchant_id\    Идентификатор мерчанта в             integer
  required           Hillstarpay. Выдается при            
                     подключении.                         

  pg_payment_id      Внутренний идентификатор платежа в   integer
  required if empty  системе Hillstarpay\                 
  pg_order_id        если отправлена вместе с полем       
                     pg_order_id, то поле pg_order_id     
                     будет проигнорировано.\              
                     Пример: 12345                        

  pg_order_id\       Идентификатор платежа в системе      string
  required if empty  мерчанта. Будьте внимательны, при    
  pg_payment_id      запросе по order_id мерчант должен   
                     самостоятельно следить за            
                     уникальностью данного параметра      
                     иначе будет выдана информация для    
                     последнего платежа с данным order_id 
                     для данного мерчанта.\               
                     Пример: 00102                        

  pg_salt\           Случайная строка\                    string
  required           Пример: some random string           

  pg_sig\            Подпись запроса                      string
  required                                                
  -----------------------------------------------------------------

** **

**Параметры ответа:**

 

+------------------------+-----------------------------------+----------+
| **Название**           | **Описание**                      | **Тип**  |
+========================+===================================+==========+
| pg_status              | Показывает результат выполнения   | string   |
|                        | запроса                           |          |
|                        |                                   |          |
|                        |   ------------------------------- |          |
|                        |   Статус   Описание               |          |
|                        |   -------- ---------------------- |          |
|                        |   ok       Запрос прошел успешно  |          |
|                        |                                   |          |
|                        |   error    Запрос прошел с        |          |
|                        |            ошибкой                |          |
|                        |   ------------------------------- |          |
+------------------------+-----------------------------------+----------+
| pg_payment_id          | Уникальный идентификатор          | integer  |
|                        | платежной транзакции в            |          |
|                        | Hillstarpay Служит ключом для     |          |
|                        | всей дальнейшей работы с          |          |
|                        | транзакцией                       |          |
+------------------------+-----------------------------------+----------+
| pg_can_reject          | 0 или 1 -- может ли платеж быть   | bool     |
|                        | отменен. Значение 1 возможно      |          |
|                        | только если статус платежа равен  |          |
|                        | ok и платежная система            |          |
|                        | предоставляет возможность отзыва  |          |
|                        | платежа                           |          |
+------------------------+-----------------------------------+----------+
| pg_payment_method      | Метод платежа                     | string   |
+------------------------+-----------------------------------+----------+
| pg_order_id            | Идентификатор платежа в системе   | string   |
|                        | мерчанта                          |          |
+------------------------+-----------------------------------+----------+
| pg_currency            | Валюта платежа                    | string   |
+------------------------+-----------------------------------+----------+
| pg_payment_status      | Статус платежа                    | string   |
+------------------------+-----------------------------------+----------+
| pg_amount              | Сумма платежа                     | integer  |
+------------------------+-----------------------------------+----------+
| pg_clearing_amount     | Сумма, списанная при проведении   | integer  |
|                        | клиринга платежа                  |          |
+------------------------+-----------------------------------+----------+
| pg_revoke_amount       | Возвращенная сумма                | integer  |
+------------------------+-----------------------------------+----------+
| pg_user_email          | E-mail плательщика                | string   |
+------------------------+-----------------------------------+----------+
| pg_card_name           | Имя плательщика                   | string   |
+------------------------+-----------------------------------+----------+
| pg_card_pan            | Маскированный номер карты (часть  | string   |
|                        | цифр номера карты скрыты)\        |          |
|                        | Пример: 5483-18XX-XXXX-0293       |          |
+------------------------+-----------------------------------+----------+
| pg_card_token          | Токен ранее сохраненной карты.    | string   |
|                        | Этот параметр передается только в |          |
|                        | случае успешно сохранении карты.  |          |
+------------------------+-----------------------------------+----------+
| pg_user_phone          | Телефон плательщика               | string   |
+------------------------+-----------------------------------+----------+
| pg_payment_date        | Дата платежа                      | datetime |
+------------------------+-----------------------------------+----------+
| pg_revoked_payments    | Список отмен по данному платежу   | array    |
+------------------------+-----------------------------------+----------+
| pg_refund_payments     | Список возвратов по данному       | array    |
|                        | платежу                           |          |
+------------------------+-----------------------------------+----------+
| pg_reference           | Уникальный идентификатор          | integer  |
|                        | банковской транзакции, который    |          |
|                        | назначается банком (RRN)          |          |
+------------------------+-----------------------------------+----------+
| pg_failure_code        | Код ошибки                        | integer  |
+------------------------+-----------------------------------+----------+
| pg_failure_description | Описание ошибки                   | string   |
+------------------------+-----------------------------------+----------+
| pg_captured            | Enum:0 1\                         | bool     |
|                        | Передается только в случае        |          |
|                        | успешной оплаты банковской картой |          |
|                        | и показывает, был ли произведен   |          |
|                        | клиринг в момент авторизации (что |          |
|                        | зависит только от настроек        |          |
|                        | мерчанта). Если значение этого    |          |
|                        | поля равно 0, мерчант должен в    |          |
|                        | последующем дать команду на       |          |
|                        | клиринг или дождаться когда       |          |
|                        | Hillstarpay сделает это сам.      |          |
+------------------------+-----------------------------------+----------+
| pg_auth_code           | Код авторизации платежа от банка  | integer  |
+------------------------+-----------------------------------+----------+
| pg_salt                | Случайная строка                  | string   |
+------------------------+-----------------------------------+----------+
| pg_sig                 | Подпись запроса                   | string   |
+------------------------+-----------------------------------+----------+

** **

** **

**Массив для pg_revoked_payments/pg_refund_payments**

 

  ------------------------------------------------------------------
  **Название**        **Описание**                        **Тип**
  ------------------- ----------------------------------- ----------
  pg_payment_id       Уникальный идентификатор платежной  integer
                      транзакции в Hillstarpay            

  pg_payment_status   Статус платежа                      string

  pg_amount           Сумма платежа                       integer

  pg_payment_date     Дата платежа                        datetime

  pg_reference        Уникальный идентификатор банковской integer
                      транзакции, который назначается     
                      банком (RRN)                        
  ------------------------------------------------------------------

 

 

**Списание платежа**

 

Магазин может самостоятельно запрашивать клиринг у банка через
FreedomPay, если в банке настроено проведение платежей в два шага --
авторизация и клиринг. В случае соответствующей настройки системы, после
проведения транзакции, транзакция будет авторизована, но не рассчитана.
Время максимальной задержки списания равно 5 дней и может регулироваться
на стороне FreedomPay от 1 до 5 дней.

 

Генерация подписи:

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_payment_id\' =\> 12345,

\'pg_clearing_amount\'=\> 10,

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'do_capture.php\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

**URL запроса**

POST
[https://api.hillstarpay.com/do_capture.php](https://api.tezpayments.kg/do_capture.php)

 

**Поля запроса:**

  -------------------------------------------------------------------
  **Название**          **Описание**                        **Тип**
  --------------------- ----------------------------------- ---------
  pg_merchant_id\       Идентификатор мерчанта в            string
  required              Hillstarpay. Выдается при           
                        подключении.                        

  pg_payment_id\        Внутренний идентификатор платежа в  integer
  required              системе Hillstarpay.\               
                        Пример: 12345                       

  pg_clearing_amount\   Сумма клиринга. Если не указать то  number
  required              возврат будет полной суммы.\        
                        Пример: 10                          

  pg_salt\              Случайная строка\                   string
  required              Пример: some random string          

  pg_sig\               Подпись запроса                     string
  required                                                  
  -------------------------------------------------------------------

** **

**Параметры ответа:**

 

  ---------------------------------------------------------------------
  **Название**           **Описание**                        **Тип**
  ---------------------- ----------------------------------- ----------
  pg_amount              Сумма платежа                       number

  pg_clearing_amount     Сумма клиринга. Если не указать то  number
                         возврат будет полной суммы          

  pg_status              Показывает результат выполнения     string
                         запроса. ok, если запрос принят на  
                         обработку.\                         
                         error в любом другом случае         

  pg_error_description   Описание ошибки в случае pg_status  string
                         равно error                         

  pg_salt                Случайная строка                    string

  pg_sig                 Подпись запроса                     string
  ---------------------------------------------------------------------

 

 

**Отмена платежа**

 

Мерчант может отменить выставленный, но ещё не оплаченный счёт. После
совершения этой операции Hillstarpay будет отказывать в проведении
платежа на этапе проверки возможности проведения платежа (если ПС
поддерживает этот запрос). Кроме того, производится аннулирование счёта
в тех ПС, которые поддерживают эту операцию. Таким образом, отмена счёта
не гарантирует невозможность его оплаты во всех ПС.

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_payment_id\' =\> 12345,

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'cancel.php\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

**URL запроса**

POST
[https://api.hillstarpay.com/cancel.php](https://api.tezpayments.kg/cancel.php)

 

**Поля запроса:**

 

  ---------------------------------------------------------------------------------
  **Название**                            **Описание**                    **Тип**
  --------------------------------------- ------------------------------- ---------
  pg_merchant_id\                         Идентификатор мерчанта в        string
  required                                системе Hillstarpay             

  pg_payment_id\                          Внутренний идентификатор        integer
  required                                платежа в системе Hillstarpay\  
                                          Пример: 12345                   

  pg_salt\                                Случайная строка\               string
  required                                Пример: some random string      

  pg_sig\                                 Подпись запроса                 string
  required                                                                

  pg_receipt_positions\[0\]\[count\]      Количество товара.\             string
                                          Пример: 2                       

  pg_receipt_positions\[0\]\[name\]       Наименование товара\            string
                                          Пример: Коврик для мыши         

  pg_receipt_positions\[0\]\[tax_type\]   Тип налога.\                    string
                                          Возможные значения:\            
                                          0 - Без налога\                 
                                          1 - НДС 0%\                     
                                          2 - НДС 12%\                    
                                          3 - НДС 12/112\                 
                                          4 - НДС 18%\                    
                                          5 - НДС 18/118\                 
                                          6 - НДС 10%\                    
                                          7 - НДС 10/110\                 
                                          8 - НДС 20%\                    
                                          9 - НДС 20/120                  

  pg_receipt_positions\[0\]\[price\]      Цена за 1 ед. товара.\          string
                                          Пример: 1000                    
  ---------------------------------------------------------------------------------

** **

**Параметры ответа:**

 

  --------------------------------------------------------------------
  **Название**           **Описание**                        **Тип**
  ---------------------- ----------------------------------- ---------
  pg_status              Показывает результат выполнения     string
                         запроса                             

  pg_error_code          Код ошибки                          integer

  pg_error_description   Описание ошибки в случае pg_status  string
                         равно error                         

  pg_salt                Случайная строка                    string

  pg_sig                 Подпись запроса                     string
  --------------------------------------------------------------------

 

 

**Возврат платежа**

 

Мерчант может отменить успешно завершившийся платеж, если платежная
система это позволяет (например, Банковские карты). В этом случае деньги
возвращаются покупателю. Вернуть можно как полную сумму платежа, так и
часть суммы. Можно делать несколько частичных возвратов до тех пор, пока
общая сумма возвратов не достигнет суммы первоначального платежа.
Отозвать платеж можно как из личного кабинета мерчанта, так и в
автоматическом режиме путем вызова скрипта.

 

Генерация подписи:

 

\$pg_merchant_id = {{Hillstarpay_merchant_id}};

\$secret_key = {{Hillstarpay_merchant_secret}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_payment_id\' =\> 12345,

\'pg_refund_amount\'=\> 50,

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'revoke.php\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

 

**URL запроса**

POST
[https://api.hillstarpay.com/revoke.php](https://api.tezpayments.kg/revoke.php)

 

**Поля запроса:**

 

  ---------------------------------------------------------------------------------
  **Название**                            **Описание**                    **Тип**
  --------------------------------------- ------------------------------- ---------
  pg_merchant_id\                         Идентификатор мерчанта в        string
  required                                Hillstarpay. Выдается при       
                                          подключении.                    

  pg_payment_id\                          Внутренний идентификатор        integer
  required                                платежа в системе Hillstarpay.\ 
                                          Пример: 12345                   

  pg_refund_amount                        Сумма возврата. Если параметр   number
                                          не передан или передан 0, то    
                                          возвращается вся сумма.\        
                                          Пример: 50                      

  pg_salt\                                Случайная строка\               string
  required                                Пример: some random string      

  pg_sig\                                 Подпись запроса                 string
  required                                                                

  pg_receipt_positions\[0\]\[count\]      Количество товара.\             string
                                          Пример: 2                       

  pg_receipt_positions\[0\]\[name\]       Наименование товара.\           string
                                          Пример: Коврик для мыши         

  pg_receipt_positions\[0\]\[tax_type\]   Тип налога.\                    string
                                          Возможные значения:\            
                                          0 - Без налога\                 
                                          1 - НДС 0%\                     
                                          2 - НДС 12%\                    
                                          3 - НДС 12/112\                 
                                          4 - НДС 18%\                    
                                          5 - НДС 18/118\                 
                                          6 - НДС 10%\                    
                                          7 - НДС 10/110\                 
                                          8 - НДС 20%\                    
                                          9 - НДС 20/120                  

  pg_receipt_positions\[0\]\[price\]      Цена за 1 ед. товара.\          string
                                          Пример: 1000                    
  ---------------------------------------------------------------------------------

** **

**Параметры ответа:**

 

  --------------------------------------------------------------------
  **Название**           **Описание**                       **Тип**
  ---------------------- ---------------------------------- ----------
  pg_status              Показывает результат выполнения    string
                         запроса                            

  pg_error_code          Код ошибки                         integer

  pg_error_description   Описание ошибки в случае если      string
                         pg_status равно error              

  pg_salt                Случайная строка                   string

  pg_sig                 Подпись запроса                    string
  --------------------------------------------------------------------

 

 

 

**Выплаты**

 

 

**На банковский счет (IBAN)**

 

**Выплата на банковский счет**

 

Для использования данных запросов Вам следует обратиться к своему
менеджеру.

** **

**URL запроса**

POST
[https://api.hillstarpay.com/api/to_iban](https://api.tezpayments.kg/api/to_iban)

 

**Поля запроса:**

 

  ----------------------------------------------------------------------
  **Название**         **Описание**                         **Тип**
  -------------------- ------------------------------------ ------------
  pg_amount\           Сумма перевода.\                     number
  required             Минимум 0.01\                        
                       Пример: 10                           

  pg_merchant_id\      Merchant ID в системе Hillstarpay    integer
  required                                                  

  pg_order_id\         ID заказа в системе мерчанта.        integer
  required             Рекомендуется уникальное, монотонно  
                       возрастающее значение.\              
                       Пример: 1234                         

  pg_recipient_iban\   Номер счета IBAN\                    string(20)
  required             Пример: KZ123412341234123412         

  pg_recipient_iin\    ИИН получателя\                      string(12)
  required             Пример: 761223455678                 

  pg_recipient_name\   Наименование получателя\             string
  required             Пример: ИВАНОВ ИВАН                  

  pg_recipient_kbe\    КБе получателя\                      integer(2)
  required             Пример: 19                           

  pg_knp\              КНП получателя\                      integer(3)
  required             Пример: 119                          

  pg_bank_bik\         БИК получателя\                      string(6)
  required             Пример: KZZSAE                       

  pg_description       \*Описание платежа\                  string
                       Пример: Описание платежа             

  pg_post_link\        Url на который отправляется ответ о  string
  required             статусе платежа\                     
                       Пример: <http://site.kz/post>        

  pg_salt\             Случайная строка, состоящая из       string
  required             произвольных цифр и латинских букв\  
                       Пример: some random string           

  pg_sig\              Подпись запроса                      string
  required                                                  
  ----------------------------------------------------------------------

** **

**Параметры ответа:**

 

  ------------------------------------------------------------------
  **Название**         **Описание**                       **Тип**
  -------------------- ---------------------------------- ----------
  pg_payment_id        Уникальный идентификатор платежной integer
                       транзакции в Hillstarpay. Служит   
                       ключом для всей дальнейшей работы  
                       с транзакцией                      

  pg_merchant_id       Идентификатор мерчанта в системе   integer
                       Hillstarpay.                       

  pg_status            Статус запроса                     string

  pg_order_id          Идентификатор заказа в системе     string
                       мерчанта                           

  pg_payment_amount    Сумма платежа                      number

  pg_payment_date      Дата и время проведения платежа    datetime

  pg_salt              Случайная строка, состоящая из     string
                       произвольных цифр и латинских букв 

  pg_sig               Подпись запроса                    string
  ------------------------------------------------------------------

 

**Post link запрос для мерчанта**

Ответ на post_link от мерчанта

 

\<?xml version=\"1.0\" encoding=\"UTF-8\"?\>

\<pg_status\>ok\</pg_status\>

 

Сервер мерчанта должен ответить статусом 200

Post link на стороне мерчанта должен быть общедоступным, без
авторизации.

***URL запроса***

POST {{post_link}}

***Headers***

  ------------------------------------------------------
  **Content-Type**   **Value**
  ------------------ -----------------------------------
  Content-Type       application/x-www-form-urlencoded

  ------------------------------------------------------

***Поля запроса***

  ------------------------------------------------------------------
  **Название**       **Описание**                         **Тип**
  ------------------ ------------------------------------ ----------
  pg_type            Тип транзакции                       string

  pg_payment_id      ID транзакции в системе Hillstarpay. integer

  pg_order_id        ID заказа в системе мерчанта         string

  pg_status          Статус операции. Enum:ok, error      string

  pg_salt            Случайная строка, состоящая из       string
                     произвольных цифр и латинских букв.\ 
                     Пример: some random string           

  pg_sig             Подпись запроса                      string
  ------------------------------------------------------------------

** **

** **

** **

**Получение статуса платежа**

 

Ok - Платеж успешен

 

Запрос:

 

curl \--location \--request POST
\'[https://api.hillstarpay.com/get_status2.php\'](https://api.greenleavespay.kz/get_status2.php)
\\

\--form \'pg_merchant_id={{{{Hillstarpay_merchant_id}}}}\' \\

\--form \'pg_order_id=00102\' \\

\--form \'pg_salt=ijoi894j4ik39lo9\' \\

\--form \'pg_sig={{{{Hillstarpay_signature}}}}\'

\# Пример подписи:

\'get_status2.php;{{{{Hillstarpay_merchant_id}}}};4567775;00102;{{secret_key}}\'

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_payment_id\>511194\</pg_payment_id\>

\<pg_transaction_status\>ok\</pg_transaction_status\>

\<pg_can_reject\>0\</pg_can_reject\>

\<pg_captured\>1\</pg_captured\>

\<pg_create_date\>2021-08-26 11:52:25\</pg_create_date\>

\<pg_salt\>41F5ZyqcOabTG5u7\</pg_salt\>

\<pg_sig\>34484775bd62986753429d6af57e94eb\</pg_sig\>

\</response\>

 

Pending - Платеж в процессе выплаты

 

Запрос:

 

curl \--location \--request POST
\'[https://api.hillstarpay.com/get_status2.php\'](https://api.greenleavespay.kz/get_status2.php)
\\

\--form \'pg_merchant_id={{{{Hillstarpay_merchant_id}}}}\' \\

\--form \'pg_order_id=00102\' \\

\--form \'pg_salt=ijoi894j4ik39lo9\' \\

\--form \'pg_sig={{{{Hillstarpay_signature}}}}\'

\# Пример подписи:

\'get_status2.php;{{{{Hillstarpay_merchant_id}}}};4567775;00102;{{secret_key}}\'

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_payment_id\>511194\</pg_payment_id\>

\<pg_transaction_status\>ok\</pg_transaction_status\>

\<pg_can_reject\>0\</pg_can_reject\>

\<pg_captured\>1\</pg_captured\>

\<pg_create_date\>2021-08-26 11:52:25\</pg_create_date\>

\<pg_salt\>41F5ZyqcOabTG5u7\</pg_salt\>

\<pg_sig\>34484775bd62986753429d6af57e94eb\</pg_sig\>

\</response\>

 

 

Failed - Платеж в ошибке

 

Запрос:

 

curl \--location \--request POST
\'[https://api.Hillstarpay/get_status2.php\'](https://api.greenleavespay.kz/get_status2.php)
\\

\--form \'pg_merchant_id={{{{Hillstarpay_merchant_id}}}}\' \\

\--form \'pg_order_id=00102\' \\

\--form \'pg_salt=ijoi894j4ik39lo9\' \\

\--form \'pg_sig={{{{Hillstarpay_signature}}}}\'

\# Пример подписи:

\'get_status2.php;{{{{Hillstarpay_merchant_id}}}};4567775;00102;{{secret_key}}\'

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_payment_id\>511180\</pg_payment_id\>

\<pg_transaction_status\>failed\</pg_transaction_status\>

\<pg_can_reject\>0\</pg_can_reject\>

\<pg_captured\>0\</pg_captured\>

\<pg_create_date\>2021-08-26 11:53:12\</pg_create_date\>

\<pg_failure_code\>5\</pg_failure_code\>

\<pg_failure_description\>Transaction
declined\</pg_failure_description\>

\<pg_salt\>VeJEycvwsTn74VEA\</pg_salt\>

\<pg_sig\>aa65c7786f5cba0cd9e6a452bfbcc7a2\</pg_sig\>

\</response\>

 

 

Мерчант может запрашивать Hillstarpay статус любого платежа,
инициированного магазином. Это может быть полезно, например, в случае
если вызов Post link не был получен мерчантом из-за временного сбоя
связи, а покупатель уже был передан на Back URL, однако статус
транзакции мерчанту еще не известен.

 

Генерация подписи:

\$pg_merchant_id = {{{{Hillstarpay_merchant_id}}}};

\$secret_key = {{{{Hillstarpay_merchant_secret}}}};

\$request = \[

\'pg_merchant_id\'=\> \$pg_merchant_id,

\'pg_order_id\' =\> 12345,

\'pg_salt\' =\> \'some random string\',

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'get_status2.php\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

 

**URL запроса**

POST
[https://api.hillstarpay.com/get_status2.php](https://api.tezpayments.kg/get_status2.php)

 

**Поля запроса:**

 

  -----------------------------------------------------------------
  **Название**       **Описание**                         **Тип**
  ------------------ ------------------------------------ ---------
  pg_merchant_id\    Идентификатор мерчанта в             string
  required           Hillstarpay. Выдается при            
                     подключении.                         

  pg_payment_id\     Внутренний идентификатор платежа в   integer
  required           системе Hillstarpay\                 
                     если отправлена вместе с полем       
                     pg_order_id, то поле pg_order_id     
                     будет проигнорировано.\              
                     Пример: 12345                        

  pg_order_id        Идентификатор платежа в системе      string
                     мерчанта. Будьте внимательны, при    
                     запросе по order_id магазин должен   
                     самостоятельно следить за            
                     уникальностью данного параметра      
                     иначе будет выдана информация для    
                     последнего платежа с данным order_id 
                     для данного магазина\                
                     Пример: 00102                        

  pg_salt\           Случайная строка\                    string
  required           Пример: some random string           

  pg_sig\            Подпись запроса                      string
  required                                                
  -----------------------------------------------------------------

** **

**Параметры ответа:**

 

  ----------------------------------------------------------------------
  **Название**             **Описание**                       **Тип**
  ------------------------ ---------------------------------- ----------
  pg_status                Показывает результат выполнения    string
                           запроса                            

  pg_payment_id            Уникальный идентификатор платежной integer
                           транзакции в Hillstarpay Служит    
                           ключом для всей дальнейшей работы  
                           с транзакцией                      

  pg_transaction_status    Статус платежа                     string

  pg_failure_code          Код ошибки                         string

  pg_failure_description   Описание ошибки                    string

  pg_can_reject            Enum:0 1.\                         integer
                           Данное поле не показывает важных   
                           вещей для выплаты                  

  pg_testing_mode          Enum:0 1\                          integer
                           0 - платеж в боевом режиме 1 -     
                           платеж в тестовом режиме           

  pg_captured              Enum:0 1\                          integer
                           Данное поле не показывает важных   
                           вещей для выплаты                  

  pg_create_date           Дата и время создания платежной    datetime
                           транзакции                         

  pg_amount                Сумма заказа                       number

  pg_salt                  Случайная строка                   string

  pg_sig                   Подпись запроса                    string
  ----------------------------------------------------------------------

** **

** **

** **

**Получение баланса**

 

Пример успешного запроса

 

Запрос:

 

curl \--location \--request POST
\'[https://api.hillstarpay.com/api/balance_status\'](https://api.greenleavespay.kz/api/balance_status)
\\

\--form \'pg_merchant_id={{{{Hillstarpay_merchant_id}}}}\' \\

\--form \'pg_salt=some random string\' \\

\--form \'pg_sig={{{{Hillstarpay_signature}}}}\'

\# Пример подписи:

\'balance_status;{{{{Hillstarpay_merchant_id}}}};some random
string;{{secret_key}}\'

Ответ:

 

\<?xml version=\"1.0\" encoding=\"UTF-8\"?\>

\<response\>

\<pg_balance\>0.00\</pg_balance\>

\<pg_status\>ok\</pg_status\>

\<pg_salt\>osWRT1FtWr\</pg_salt\>

\<pg_sig\>9087fd0c7a26334f53f83f0bd61e6b80\</pg_sig\>

\</response\>

 

Генерация подписи:

\$pg_merchant_id = {{{{Hillstarpay_merchant_id}}}};

\$secret_key = {{{{Hillstarpay_merchant_secret}}}};

\$request = \[

\'pg_merchant_id\' =\> \$pg_merchant_id,

\'pg_salt\' =\> \'some random string\'

\];

//generate a signature and add it to the array

ksort(\$request); //sort alphabetically

array_unshift(\$request, \'balance_status\');

array_push(\$request, \$secret_key);

\$request\[\'pg_sig\'\] = md5(implode(\';\', \$request)); // signature

unset(\$request\[0\], \$request\[1\]);

 

**URL запроса**

POST
[https://api.hillstarpay.com/api/balance_status](https://api.tezpayments.kg/api/balance_status)

 

**Поля запроса:**

 

  ---------------------------------------------------------------------------------------
  **Название**       **Описание**                                               **Тип**
  ------------------ ---------------------------------------------------------- ---------
  pg_merchant_id\    Merchant ID в системе Hillstarpay.                         integer
  required                                                                      

  pg_currency        Валюта баланса\                                            string
                     См. в разделе [Справочник                                  
                     валют](https://customer.greenleavespay.kz/dev/currency)\   
                     Пример: KZT                                                

  pg_salt\           Случайная строка, состоящая из произвольных цифр и         string
  required           латинских букв\                                            
                     Пример: some random string                                 

  pg_sig\            Подпись запроса                                            string
  required                                                                      
  ---------------------------------------------------------------------------------------

** **

**Параметры ответа:**

 

  ------------------------------------------------------------------
  **Название**      **Описание**                          **Тип**
  ----------------- ------------------------------------- ----------
  pg_balance        Баланс                                number

  pg_status         Статус запроса                        string

  pg_salt           Случайная строка, состоящая из        string
                    произвольных цифр и латинских букв    

  pg_sig            Подпись запроса                       string
  ------------------------------------------------------------------

 

 

 

**На баланс мобильного**

 

Hillstarpay предлагает возможность провести выплату на баланс мобильного
телефона, если мобильный оператор плательщика поддерживает данную
возможность. Доступные мобильные операторы:

Tele2\
Altel\
Beeline\
Activ\
Kcell

** **

** **

**Инициализация платежа**

 

Запрос:

curl \--location \--request POST
\'[https://api.hillstarpay.com/init_payout.php\'](https://api.greenleavespay.kz/init_payout.php)
\\

\--form \'pg_order_id=23\' \\

\--form \'pg_merchant_id={{Hillstarpay_merchant_id}}\' \\

\--form \'pg_amount=25\' \\

\--form \'pg_description=test\' \\

\--form \'pg_salt=molbulak\' \\

\--form \'pg_sig={{Hillstarpay_signature}}\' \\

\--form \'pg_order_time_limit=2020-12-31 12:00:00\',

\# Пример подписи:

\'init_payout.php;25;test;{{Hillstarpay_merchant_id}};23;2020-12-31
12:00:00;molbulak;{{secret_key}}\'

Ответ:

 

\<?xml version=\"1.0\" encoding=\"utf-8\"?\>

\<response\>

\<pg_status\>ok\</pg_status\>

\<pg_payment_id\>4567788\</pg_payment_id\>

\<pg_merchant\>{{Hillstarpay_merchant_id}}\</pg_merchant\>

\<pg_order_id\>23\</pg_order_id\>

\<pg_salt\>bdwLavL9lg6It91b\</pg_salt\>

\<pg_sig\>709633e91387c56ac6fb7cb33d1e07d8\</pg_sig\>

\</response\>

 

Если в ответе pg_status равен ok, мерчанту необходимо отправить запрос
для продолжения выплаты.

** **

**URL запроса**

POST
[https://api.hillstarpay.com/mfs/payout](https://api.tezpayments.kg/mfs/payout)

 

**Поля запроса:**

  ------------------------------------------------------------------
  **Название**        **Описание**                        **Тип**
  ------------------- ----------------------------------- ----------
  pg_merchant_id\     Идентификатор мерчанта в системе    string
  required            Hillstarpay.                        

  pg_payment_id\      Внутренний идентификатор платежа в  integer
  required            системе Hillstarpay\                
                      Пример: 12345                       

  pg_abonent_phone\   Номер телефон на который поступит   string
  required            баланс.\                            
                      Пример: 77077777777                 

  pg_salt\            Случайная строка\                   string
  required            Пример: some random string          

  pg_sig\             Подпись запроса                     string
  required                                                
  ------------------------------------------------------------------

** **

**Параметры ответа:**

 

  ------------------------------------------------------------------
  **Название**         **Описание**                       **Тип**
  -------------------- ---------------------------------- ----------
  pg_status            Статус платежа                     string

  pg_merchant_id       Идентификатор мерчанта в системе   integer
                       Hillstarpay                        

  pg_payment_id        Уникальный идентификатор платежной integer
                       транзакции в Hillstarpay. Служит   
                       ключом для всей дальнейшей работы  
                       с транзакцией                      

  pg_order_id          Идентификатор заказа в системе     string
                       мерчанта                           

  pg_payment_amount    Сумма платежа                      number

  pg_reference         Уникальный идентификатор           string
                       транзакции оператора               

  pg_payment_date      Дата и время проведения платежа    datetime

  pg_salt              Случайная строка, состоящая из     string
                       произвольных цифр и латинских букв 

  pg_sig               Подпись запроса                    string\
                                                          \
                                                           
  ------------------------------------------------------------------

** **

** **

** **

**Справочник кодов ошибок возможных при запросах**

 

  -----------------------------------------------------------------
  Код ошибки  Описание ошибки
  ----------- -----------------------------------------------------
  9992        Вызываемый метод не активирован для магазина.

  9993        Не найден/не указан success/error/post-link URL.

  9994        Запрошенное действие отключено в настройках магазина

  9995        Платеж в тестовом режиме

  9996        Отсутствует или не действует контракт с магазином

  9997        Неверный номер магазина

  9998        Некорректная подпись запроса

  9999        Ошибка системы

  10000       Ошибка оплаты. Сервис недоступен. Повторите попытку
              позже.

  10001       Ошибка списания с карты банка-эмитента. Повторите
              попытку позже

  10003       Превышено число попыток ввода проверочного кода

  10004       3DS код не введен или введен некорректно

  10005       Неверно указаны данные карты списания

  10006       Превышен лимит частоты оплат

  10007       Списание с карты отклонено по безопасности
              банком-эмитентом

  10008       Неверно введены данные карты. Попробуйте повторить
              оплату.

  10009       Недостаточно средств Пополните счет или используйте
              другую карту

  10010       Ограничения на карте. Свяжитесь с банком выпустившим
              карту

  10011       Платеж успешно завершен

  10012       Невозможно отменить транзакцию. Обратитесь в магазин

  10013       Карта данной страны не разрешена для проведения
              транзакции

  10014       Превышен временной интервал. Свяжитесь с магазином

  10015       Ошибка оплаты. Транзакция уже совершена

  10016       Техническая ошибка списания с карты

  10017       Срок действия карты истек.Просим оплатить с другой
              карты

  10018       Время жизни операции списания истекло. Повторите
              операцию

  10019       Операция не выполнена. Попробуйте использовать другую
              карту

  10020       Сумма возврата превышает сумму оплаты. Обратитесь в
              магазин

  10021       Недействительная транзакция - повторить попытку

  10025       Ошибка на стороне Международной Платежной системы

  10026       Ошибка выплаты. Обратитесь в Магазин

  10028       Превышен лимит по частоте оплаты. Свяжитесь с
              магазином

  10029       В данный момент выплаты на IBAN не работают

  10030       Ошибка минимальной суммы. Просим обратиться в Магазин

  10031       Некорректный номер телефона

  10032       Неправильный/несуществующий номер карты

  11000       Ошибка оплаты, сервис недоступен. Обратитесь в Службу
              поддержки

  11001       Операция неуспешна. Обратитесь в службу поддержки
              оператора.

  11002       Введен неверный код SMS. Повторите еще раз

  11003       На балансе Вашего номера образовалась задолженность

  11004       Введен неверный или несуществующий номер

  11005       Сумма списания введена некорректно

  11006       Недостаточно средств для проведения операции

  11007       Вы достигли лимита количества попыток кода
              подтверждения.

  11008       Срок действия кода подтверждения истек. Повторите
              операцию

  11009       Операция отклонена. Обратитесь в службу поддержки
              оператора

  11010       Вы превысили количество неуспешных попыток ввода SMS

  11011       Операция неуспешна, на номере имеются ограничения

  11012       Вы достигли лимита на количество платежей в сутки.

  11013       Операция неуспешна. Вы пытаетесь повторно провести
              операцию

  11014       Непредвиденная ошибка. Попробуйте позднее

  11015       Вы превысили единовременный лимит в размере 50МРП

  11016       Минимальная сумма платежа 1000тг

  11017       Платеж уже отменен

  11018       Платеж уже возвращен

  11019       Вы превысили месячный лимит в размере 1000МРП

  11020       Дневной лимит по количеству плажетей составляет 30
              платежей

  12000       Ошибка ЦУС

  10033       Ошибка отмены платежа, отмена уже была проведена
              ранее.

  10034       Ошибка возврата платежа, по платежу необходимо
              провести клиринг

  10035       Ошибка платежа, не успешные платежи не могут пройти
              клиринг

  10036       Ошибка. Списание денежных средств уже было
              произведено

  10022       Сумма превышает допустимый лимит на карте.

  10037       Карта списания временно заблокирована. Обратитесь в
              банк-эмитент

  99999       Неизвестная ошибка платежной системы

  11021       Не удалось определить оператора или номер введён
              некорректно

  11022       Параметры платежа нарушают ограничения.

  11023       Платежи с номеров этого мобильного оператора не
              разрешены.

  10038       Карта операции списания заблокирована. Обратитесь в
              ваш банк

  10039       Некорректная операция списания. Обратитесь в
              банк-эмитент

  10040       Неверный номер счета/карты, обратитесь в банк

  10041       Счет/карта закрыта, обратитесь в банк

  9013        Ошибка отмены платежа, не успешные платежи нельзя
              отменить.

  10023       Превышено количество попыток ввода PIN-кода

  10024       Неподтвержденный PIN, обратитесь в банк

  11024       Отказано по причине нарушения безопасности.
              Обратитесь в банк

  11026       По платежу имеется ChargeBack. Возврат невозможен.

  11025       Необходимо провести клиринг для возврата, или
              отменить платеж.

  11027       Ошибка оплаты. Географические ограничения по
              банковской карте.

  11028       Карта временно заблокирована. Повторите запрос после
              30 дней.

  11036       Карта заблокирована на 30 дней, воспользуйтесь другой
              картой.

  11049       Код подтверждения 3DS не введен

  11037       3DSecure не введен

  11050       PIN карты списания введен неверно

  11051       Блокировка по лимиту

  11052       Общая ошибка

  11053       Банк-эмитент не смог провести авторизацию
              3dsecure-карты

  8888        Недостаточно средств! Пополните выплатной баланс

  8889        Ошибка прохождения 3D-Secure

  11054       С момента проведения данной транзакции прошло более
              180 дней.

  9991        Неуникальный идентификатор заказа

  11030       Абоненту необходимо пройти идентификацию

  11031       Максимальная сумма платежа 15000 сом

  11032       Минимальная сумма платежа 5 сом

  9990        Карта уже сохранена. Введите другую карту на
              предыдущем шаге

  9909        Транзакция не найдена

  9403        Неверная валидация

  9908        Платеж с данным order_id уже существует

  10042       Карта не поддерживает 3DS. Обратитесь в банк
              выпустивший карту

  9901        Срок действия карты закончился

  9073        Выберите другой метод платежа, либо обратитесь в
              магазин

  11055       Попробуйте другую карту. Ошибка карты или есть
              гео-ограничения

  9090        Сумма выплаты превышает предельную (требуется
              идентификация)

  11089       Карты данной платёжной системы не поддерживаются

  11085       Требуется заполнить схему pg_split_refunds

  11086       Не установлены параметры сплитования

  11076       Неверный id продавца или продавец заблокирован

  11064       Неверный ИИН/БИН

  11062       Неверный номер карты отправителя

  11063       Неверный номер карты получателя

  11069       Неверный статус платежа

  11067       Неверный тип запроса

  11065       Некорректный CVC/CVV карты списания

  11066       Некорректный XML

  11071       Неправильный идентификатор первого платежа

  11070       Неправильный идентификатор реккурентного платежа

  11084       Сумма возврата не равна сумме частичных возвратов

  11072       Ошибка отмены платежа, был проведен клиринг

  11080       Параметр pg_split_refunds заполнен для
              несплитованного платежа

  11068       Платеж не найден

  11079       Необходимо прислать скорректированную схему
              сплитования

  11082       Сумма возврата позиции слишком большая

  11078       Сумма не должна превышать сумму платежа минус
              комиссия

  11083       Сумма возмещения позиции слишком большая

  11077       Сумма оплат покупателем по всем позициям не равна
              сумме платежа

  11081       Указан неверный идентификатор позиции

  11087       Заявка аннулирована провайдером

  11061       Неверный номер/идентификатор платежа

  11088       Отказ со стороны банка провайдера

  11074       Ошибка клиринга платежа, сумма для клиринга превышена

  11060       Ошибка настройки магазина, обратитесь в поддержку

  10043       По карте не подключено SMS-информирование. Обратитесь
              в банк.

  11040       Вы не можете установить скидку на комиссию

  11041       Вы должны выбрать один тип скидки

  11042       Вы должны выбрать тип скидки

  11090       Ошибка клиринга платежа, платеж был ранее отменен.

  9102        Ошибка возврата платежа, возврат находится в процессе
              выполнения

  9103        Ошибка отмены платежа, отмена находится в процессе
              выполнения

  9043        Ошибка файла конфигурации терминала платежной
              системы.

  100066      Превышен лимит на карте списания. Обратитесь в банк
              эмитент

  10089       Выплата на указанную карту в указанной валюте
              недоступна.

  10088       Перевод с указанной карты и в указанной валюте
              недоступен.

  10110       Ограничения на карте получателя.

  100161      Техническая ошибка проведения выплаты. Повторите
              позже.

  100091      Недостаточно средств. Просим пополнить баланс.

  100011      Ошибка выплаты. Обратитесь в банк выпустивший карту

  1000661     Превышен лимит на карте. Свяжитесь с банком
              выпустившим карту

  100162      Ошибка проведения выплаты. Обратитесь в службу
              поддержки сайта.

  12095       Оплата вашей картой недоступно в магазине. Обратитесь
              в магазин

  90081       Некорректная сумма возврата. Проверьте сумму
              повторите попытку.

  100181      Время жизни платежа превышено

  100231      Превышено количество попыток ввода PIN-кода (выплаты)

  110051      Сумма введена некорректно(выплаты)

  100371      Карта временно заблокирована (выплаты)

  100221      Сумма превышает допустимый лимит на карте (выплаты)

  100241      Suspected fraud(выплаты)

  100171      Срок действия карты истек (выплаты)

  100381      Карта заблокирована и подлежит удержанию

  100401      Неверный номер счета/карты (выплаты)

  1001612     ошибка банка эмитента

  100101      Ограничения опреации выплат. Обратитесь в банк
              выпустивший карту

  100391      Ошибка операции выплаты. Повторите попытку позже

  9105        Операция проверки данных для оплаты в процессе
              выполнения

  1823        Поле БИК заполнено некорректно, исправьте и повторите
              отправку

  10111       Списание с карты отменено пользователем. Повторите
              попытку.

  10112       Ошибка списания с карты на стороне банка.

  10113       Ошибка списания с карты на стороне банка. Обратитесь
              в банк.

  10114       Техническая ошибка проведения транзакции на стороне
              эквайера

  10115       Техническая ошибка проведения списания с карты

  10044       Ошибка отмены платежа

  10045       Списание с карты отклонено по соображениям
              безопасности

  110100      Ошибка платежа. Необходимо провести оплату с 3DS

  9027        Ключ уже используется для другого платежа
  -----------------------------------------------------------------

 

 

 
